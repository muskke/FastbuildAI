import{S as N,s as P,_ as L}from"./DejzaY3E.js";import{_ as j}from"./B3a7q0NG.js";import{_ as D}from"./BPM9EkAu.js";import{c as R,a as p,b as E,_ as O,d as T}from"./Cp1wKOi2.js";import{q as W,U as h,r as v,k as V,aM as A,aN as J,d as Q,o as Y,B as t,y as o,Q as n,J as r,av as G,S as m,R as u,W as H,_ as K}from"#entry";import{_ as X}from"./D8tVY6MN.js";import{M as S}from"./CrZQOMYR.js";import{u as $}from"./D1hA3BKJ.js";import"./DQ3OFFxE.js";import"./DTsPWcUW.js";/* empty css        */import"./DlAUqK2U.js";import"./Bcm0fnuO.js";import"./C_wlX4O4.js";import"./DLXS5diL.js";import"./2-Qad1x6.js";import"./s2lweFA8.js";import"./CTcKPVt7.js";import"./Vq6WnXMj.js";import"./CqkleIqs.js";const Z={class:"px-8 pt-8"},ee={class:"flex items-center gap-1 text-xs"},te={class:"flex items-center gap-1 text-xs"},oe={class:"flex flex-1 gap-2 py-8"},$e=W({__name:"forget",emits:["switchComponent"],setup(se,{emit:C}){const k=C,f=h(),_=v([{value:"中国大陆",label:"86"}]),g=v(_.value[0]),U=R({mobile:p().required("请输入手机号").matches(/^1[3-9]\d{9}$/,"请输入正确的手机号码"),code:p().required("请输入验证码"),password:p().required("请输入新密码").min(6,"密码长度不能少于6个字符").max(25,"密码长度不能超过25个字符").matches(/^(?=.*[a-z])(?=.*[0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])/,"密码必须为数字，字母或符号组合"),password_confirm:p().required("请确认密码").oneOf([E("password")],"两次输入的密码不一致")}),a=V({mobile:"",code:"",password:"",password_confirm:""}),i=V({isCounting:!1,text:"获取验证码"}),{lockFn:z,isLock:q}=$(async()=>{if(i.isCounting!==!0){i.text="正在发送中";try{await A({scene:N.FIND_PASSWORD,mobile:a.mobile}),i.isCounting=!0;let l=60;i.text=`${l}s`;const e=P(()=>{l--,i.text=`${l}s`,l===0&&(clearInterval(e),i.isCounting=!1,i.text="重新发送")},1e3);f.error("验证码发送成功，请注意查收",{title:"发送成功",duration:3e3})}catch(l){console.error("发送验证码失败:",l),i.isCounting=!1,i.text="重新发送",f.error("验证码发送失败，请稍后重试",{title:"发送失败",duration:3e3})}}}),{lockFn:F,isLock:B}=$(async()=>{try{await J(a)}catch(l){console.log("重置密码失败=>",l)}});return(l,e)=>{const I=L,x=j,b=D,d=T,c=H,w=X,y=K,M=O;return Y(),Q("div",Z,[t(r(S),{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"tween",stiffness:300,damping:30,delay:.2},class:"relative"},{default:o(()=>[...e[7]||(e[7]=[n("h2",{class:"mb-2 text-2xl font-bold"},"忘记密码",-1),n("p",{class:"text-muted-foreground mb-4 text-sm"},"设置新密码以继续使用您的账户",-1)])]),_:1}),t(r(S),{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"tween",stiffness:300,damping:30,delay:.4},class:"relative"},{default:o(()=>[t(M,{schema:r(U),state:a,onSubmit:r(F)},{default:o(()=>[t(d,{label:"手机号",name:"mobile",required:""},{default:o(()=>[t(b,{modelValue:a.mobile,"onUpdate:modelValue":e[2]||(e[2]=s=>a.mobile=s),class:"w-full",size:"lg",placeholder:"请输入手机号码",autocomplete:"off",ui:{base:"!pl-24"}},{leading:o(()=>[n("div",{class:"flex items-center text-sm",onClick:e[1]||(e[1]=G(()=>{},["stop","prevent"]))},[e[8]||(e[8]=n("span",{class:"mr-[1px] pb-[1px]"},"+",-1)),t(I,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),"trailing-icon":"heroicons:chevron-up-down-20-solid",ui:{base:"!ring-0",content:"z-999 w-34"},class:"w-16",items:_.value},{item:o(({item:s})=>[m(u(s.value)+" +"+u(s.label),1)]),_:1},8,["modelValue","items"])]),t(x,{class:"h-1/2",orientation:"vertical"})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"验证码",name:"code",class:"mt-2",required:""},{default:o(()=>[t(b,{id:"code",modelValue:a.code,"onUpdate:modelValue":e[3]||(e[3]=s=>a.code=s),size:"lg",placeholder:"请输入验证码",autocomplete:"off",ui:{root:"w-full",trailing:"pr-0"}},{trailing:o(()=>[t(x,{class:"h-1/2",orientation:"vertical"}),t(c,{variant:"link",ui:{base:"w-[90px] justify-center"},disabled:r(q),onClick:r(z)},{default:o(()=>[m(u(i.text),1)]),_:1},8,["disabled","onClick"])]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"新密码",name:"password",class:"mt-3",required:""},{help:o(()=>[n("div",ee,[t(y,{name:"tabler:alert-circle",size:"14"}),e[9]||(e[9]=m(" 密码必须为6-25位数字+字母或符号组合 ",-1))])]),default:o(()=>[t(w,{modelValue:a.password,"onUpdate:modelValue":e[4]||(e[4]=s=>a.password=s),class:"w-full",type:"password",size:"lg",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),t(d,{label:"确认密码",name:"password_confirm",class:"mt-3",required:""},{help:o(()=>[n("div",te,[t(y,{name:"tabler:alert-circle",size:"14"}),e[10]||(e[10]=m(" 密码必须为6-25位数字+字母或符号组合 ",-1))])]),default:o(()=>[t(w,{modelValue:a.password_confirm,"onUpdate:modelValue":e[5]||(e[5]=s=>a.password_confirm=s),class:"w-full",type:"password",size:"lg",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1}),n("div",oe,[t(c,{variant:"outline",color:"primary",size:"lg",ui:{base:"flex-1 justify-center"},onClick:e[6]||(e[6]=s=>k("switchComponent","account-login"))},{default:o(()=>[...e[11]||(e[11]=[m(" 返回登录 ",-1)])]),_:1}),t(c,{color:"primary",type:"submit",size:"lg",ui:{base:"flex-1 justify-center"},loading:r(B)},{default:o(()=>[...e[12]||(e[12]=[m(" 确认修改 ",-1)])]),_:1},8,["loading"])])]),_:1},8,["schema","state","onSubmit"])]),_:1})])}}});export{$e as default};
