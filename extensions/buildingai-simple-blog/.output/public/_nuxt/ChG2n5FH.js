const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./_BzI5IoC.js","./BjyhBLpb.js","./BPM9EkAu.js","./Cp1wKOi2.js","./CqkleIqs.js","./ChTZtME1.js","./8D7xt9jI.js","./BciU42NY.js","./2-Qad1x6.js","./DLXS5diL.js","./Djs9Agcq.js","./B2YVs6m2.js","./y35Lf0Nz.js","./DOVLrnnX.js","./D1hA3BKJ.js"])))=>i.map(i=>d[i]);
import{q as U,U as F,V as M,$ as K,a0 as L,k as T,r as B,f as P,l as E,d as O,Q as b,B as c,a1 as z,J as a,y as f,R as u,Y as N,Z as H,o as j,S,W as q,K as l}from"#entry";import{_ as G}from"./vRyQvext.js";import{_ as J}from"./CVJlEypN.js";import{_ as Q}from"./3ql5fPzj.js";import{_ as W}from"./BPM9EkAu.js";import{_ as Y}from"./Cp_ETqS-.js";import{u as Z,_ as X}from"./Ctrb6MDQ.js";import{a as ee,b as te,c as oe}from"./DOVLrnnX.js";import{u as ae}from"./D1hA3BKJ.js";import"./CNxEN1aC.js";import"./CTcKPVt7.js";import"./DLXS5diL.js";import"./Vq6WnXMj.js";import"./CGkG6ujT.js";import"./s2lweFA8.js";import"./jOvN_MzA.js";import"./C_wlX4O4.js";import"./Djs9Agcq.js";import"./2-Qad1x6.js";import"./YGBcfQFB.js";import"./y35Lf0Nz.js";const le={class:"column-list-container pb-5"},se={class:"mb-4 flex flex-wrap gap-4"},re={class:"flex items-end gap-2 md:ml-auto"},ne={class:"border-default mt-auto flex items-center justify-between gap-3 border-t pt-4"},ie={class:"text-muted text-sm"},Ie=U({__name:"list",setup(ce){const C=N(()=>H(()=>import("./_BzI5IoC.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),w=G,n=q,A=J,k=Q,h=F(),{t:o}=M(),V=K(),r=L("table"),_=T({name:""}),y=B([]),d=P(()=>({select:o("column.list.table.columns.select"),name:o("column.list.table.columns.name"),sort:o("column.list.table.columns.sort"),articleCount:o("column.list.table.columns.articleCount"),createdAt:o("column.list.table.columns.createdAt"),actions:o("column.list.table.columns.actions")})),R=[{id:"select",header:({table:e})=>l(w,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>e.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:e})=>l(w,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>e.toggleSelected(!!t),ariaLabel:"Select row"})},{accessorKey:"name",header:()=>l("p",{class:""},`${d.value.name}`),cell:({row:e})=>{const t=e.original;return l("div",{class:"flex items-center gap-3"},[l("div",void 0,[l("p",{class:"font-medium"},t.name),t.description?l("p",{class:"truncate text-sm text-muted-foreground dark:text-gray-400"},t.description):null])])}},{accessorKey:"sort",header:({column:e})=>{const t=e.getIsSorted();return l(n,{color:"neutral",variant:"ghost",label:d.value.sort,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("sort");return l("span",{class:"text-accent-foreground"},t||0)}},{accessorKey:"articleCount",header:()=>l("p",{class:""},`${d.value.articleCount}`),cell:({row:e})=>{const t=e.getValue("articleCount");return l("span",{class:"text-accent-foreground"},t||0)}},{accessorKey:"createdAt",header:({column:e})=>{const t=e.getIsSorted();return l(n,{color:"neutral",variant:"ghost",label:d.value.createdAt,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("createdAt");if(!t)return l("span",{class:"text-accent-foreground text-sm"},"-");const i=t instanceof Date?t.toISOString():typeof t=="string"?t:"";return l("span",{class:"text-accent-foreground text-sm"},i?l(k,{datetime:i,mode:"date"}):"-")}},{id:"actions",header:()=>l("p",{class:""},`${d.value.actions}`),size:40,enableSorting:!1,enableHiding:!1,cell:({row:e})=>l("div",{class:"flex items-center gap-1"},[l(n,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:o("column.list.table.actions.edit"),onClick:()=>{v(e.original.id)}}),l(n,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:o("column.list.table.actions.delete"),onClick:()=>{x(e.original.id)}})])}],{lockFn:p,isLock:$}=ae(async()=>{try{const e=await oe(_);y.value=e||[]}catch(e){console.error("获取栏目列表失败:",e),h.error(o("column.list.messages.fetchFailed"))}}),v=async(e=null)=>{await V.create(C).open({id:e}).result&&p()},x=async e=>{try{const t=Array.isArray(e),i=o("column.list.messages.warmTip"),g=o(t?"column.list.messages.batchDeleteConfirm":"column.list.messages.deleteConfirm");await Z({color:"error",title:i,content:g,confirmText:o("column.list.table.actions.delete"),ui:{content:"!w-sm"}}),t?await ee(e):await te(e),p(),h.success(o("column.list.messages.deleteSuccess"))}catch(t){console.error("删除失败:",t),h.error(o("column.list.messages.deleteFailed"))}},D=()=>{p()};return E(()=>p()),(e,t)=>{const i=W,g=Y,I=X;return j(),O("div",le,[b("div",se,[c(i,{modelValue:_.name,"onUpdate:modelValue":t[0]||(t[0]=s=>_.name=s),placeholder:a(o)("column.list.search.placeholder"),icon:"i-heroicons-magnifying-glass",onKeyup:z(D,["enter"])},null,8,["modelValue","placeholder"]),b("div",re,[c(a(n),{color:"error",variant:"subtle",label:a(o)("column.list.table.actions.batchDelete"),icon:"i-heroicons-trash",disabled:!a(r)?.tableApi?.getFilteredSelectedRowModel().rows.length,onClick:t[1]||(t[1]=s=>x(a(r)?.tableApi?.getFilteredSelectedRowModel().rows.map(m=>m.original.id)))},{trailing:f(()=>[c(g,null,{default:f(()=>[S(u(a(r)?.tableApi?.getFilteredSelectedRowModel().rows.length),1)]),_:1})]),_:1},8,["label","disabled"]),c(a(A),{items:a(r)?.tableApi?.getAllColumns().filter(s=>s.getCanHide()).map(s=>({label:a(d)[s?.id]||s.columnDef.header,type:"checkbox",checked:s.getIsVisible(),onUpdateChecked(m){a(r)?.tableApi?.getColumn(s.id)?.toggleVisibility(!!m)},onSelect(m){m?.preventDefault()}})),content:{align:"end"}},{default:f(()=>[c(a(n),{label:a(o)("column.list.table.actions.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),c(a(n),{icon:"i-heroicons-plus",color:"primary",onClick:t[2]||(t[2]=s=>v())},{default:f(()=>[S(u(a(o)("column.list.table.actions.create")),1)]),_:1})])]),c(I,{loading:a($),data:a(y),columns:R,class:"shrink-0",ref_key:"table",ref:r,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},null,8,["loading","data"]),b("div",ne,[b("div",ie,u(a(r)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" / "+u(a(r)?.tableApi?.getFilteredRowModel().rows.length||0)+" "+u(a(o)("column.list.table.actions.selected"))+". ",1)])])}}});export{Ie as default};
