import{q as I,f as N,ag as D,d as h,o as y,ac as b,B as r,i as g,y as m,Q as u,s as w,R as $,W as j,S as x,C as E,J as o,aU as L,V as O,r as T,U as F,l as R,_ as A}from"#entry";import{_ as G}from"./BPM9EkAu.js";import{c as J,a as P,_ as Q,d as W}from"./Cp1wKOi2.js";import{_ as H}from"./ChTZtME1.js";import{_ as K}from"./8D7xt9jI.js";import{d as X}from"./B2YVs6m2.js";import{d as Y,e as Z,f as ee}from"./DOVLrnnX.js";import{u as S}from"./D1hA3BKJ.js";import"./CqkleIqs.js";import"./BciU42NY.js";import"./2-Qad1x6.js";import"./DLXS5diL.js";import"./Djs9Agcq.js";import"./y35Lf0Nz.js";const oe=["id"],te={class:"pr- flex items-center justify-between"},le={class:"text-lg font-medium md:text-xl"},se={key:0,class:"text-muted-foreground mt-1 text-sm"},ae={class:"flex-1 overflow-hidden overflow-y-auto"},ne={class:"flex justify-end gap-2"},ie=I({inheritAttrs:!1,__name:"index",props:{title:{default:"Title"},description:{},transition:{type:Boolean,default:!0},fullscreen:{type:Boolean,default:!1},dismissible:{type:Boolean,default:!1},overlay:{type:Boolean,default:!0},portal:{type:Boolean,default:!0},open:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},disabledClose:{type:Boolean,default:!1},contentId:{default:""},closeIcon:{default:"tabler:x"},closeOnEsc:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!1},ui:{default:()=>({})}},emits:["update:open","update:modelValue","open","close","confirm"],setup(t,{expose:_,emit:c}){const d=t,e=c,a=N({get:()=>d.open??d.modelValue??!1,set:l=>{e("update:open",l),e("update:modelValue",l)}});function s(){d.disabledClose||(a.value=!1,e("close"))}function C(){a.value=!1,e("confirm")}function v(){a.value=!0,console.log("open",a.value),e("open")}return D(a,l=>{l&&e("open")}),X({"alt+o":()=>{a.value=!a.value},escape:()=>{a.value&&d.closeOnEsc&&!d.disabledClose&&s()}}),_({close:s,open:v}),(l,f)=>{const n=j,i=K;return y(),h("div",null,[l.$slots.trigger?(y(),h("div",{key:0,class:"cursor-pointer",onClick:v},[g(l.$slots,"trigger")])):b("",!0),r(i,E({open:o(a),"onUpdate:open":f[0]||(f[0]=k=>L(a)?a.value=k:null)},l.$attrs,{ui:t.ui,portal:t.portal,fullscreen:t.fullscreen,overlay:t.overlay,transition:t.transition,dismissible:t.dismissible,onClose:f[1]||(f[1]=()=>{a.value=!1,e("close")})}),{content:m(()=>[u("div",{id:t.contentId,class:"relative flex flex-col gap-4 overflow-hidden p-4 sm:p-6"},[u("div",te,[g(l.$slots,"title",{},()=>[u("div",null,[u("h2",le,$(t.title),1),t.description?(y(),h("p",se,$(t.description),1)):b("",!0)])]),t.disabledClose?b("",!0):(y(),w(n,{key:0,class:"absolute top-4 right-4",icon:t.closeIcon,color:"neutral",size:"sm",variant:"ghost","aria-label":"Close modal",onClick:s},null,8,["icon"]))]),u("div",ae,[g(l.$slots,"default")]),t.showFooter||l.$slots.footer?g(l.$slots,"footer",{key:0},()=>[u("div",ne,[r(n,{color:"neutral",variant:"soft",size:"lg",onClick:s},{default:m(()=>[x($(l.$t("common.cancel")),1)]),_:1}),r(n,{color:"primary",size:"lg",onClick:C},{default:m(()=>[x($(l.$t("common.confirm")),1)]),_:1})])]):b("",!0)],8,oe)]),_:3},16,["open","ui","portal","fullscreen","overlay","transition","dismissible"])])}}}),re={key:0,class:"flex items-center justify-center",style:{padding:"100px 0"}},de={class:"space-y-4"},ce={class:"mt-6 flex justify-end gap-3"},we=I({__name:"edit",props:{id:{}},emits:["close"],setup(t,{emit:_}){const c=t,d=_,{t:e}=O(),a=J({name:P().required(e("column.edit.form.name.required"))}),s=T({name:"",description:"",sort:0}),{lockFn:C,isLock:v}=S(async()=>{if(c.id)try{const n=await Y(c.id);s.value={name:n.name,description:n.description||"",sort:n.sort||0}}catch(n){console.error("获取详情失败:",n)}}),{lockFn:l,isLock:f}=S(async()=>{try{c.id?await Z(c.id,s.value):await ee(s.value),F().success(c.id?e("column.edit.messages.updateSuccess"):e("column.edit.messages.createSuccess")),d("close",!0)}catch(n){console.error("提交失败:",n),F().error(c.id?e("column.edit.messages.updateFailed"):e("column.edit.messages.createFailed"))}});return R(()=>{C()}),(n,i)=>{const k=A,V=G,B=W,q=H,U=j,z=Q,M=ie;return y(),w(M,{title:t.id?o(e)("column.edit.title.edit"):o(e)("column.edit.title.create"),description:t.id?o(e)("column.edit.description.edit"):o(e)("column.edit.description.create"),ui:{content:"w-md"},onClose:i[4]||(i[4]=p=>d("close"))},{default:m(()=>[o(v)?(y(),h("div",re,[r(k,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):(y(),w(z,{key:1,state:o(s),schema:o(a),class:"space-y-2",onSubmit:o(l)},{default:m(()=>[u("div",de,[r(B,{label:o(e)("column.edit.form.name.label"),name:"name",required:""},{default:m(()=>[r(V,{modelValue:o(s).name,"onUpdate:modelValue":i[0]||(i[0]=p=>o(s).name=p),placeholder:o(e)("column.edit.form.name.placeholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(B,{label:o(e)("column.edit.form.description.label"),name:"description"},{default:m(()=>[r(q,{"model-value":o(s).description||"","onUpdate:modelValue":i[1]||(i[1]=p=>o(s).description=p||void 0),placeholder:o(e)("column.edit.form.description.placeholder"),rows:3,ui:{root:"w-full"}},null,8,["model-value","placeholder"])]),_:1},8,["label"]),r(B,{label:o(e)("column.edit.form.sort.label"),name:"sort"},{default:m(()=>[r(V,{modelValue:o(s).sort,"onUpdate:modelValue":i[2]||(i[2]=p=>o(s).sort=p),type:"number",placeholder:o(e)("column.edit.form.sort.placeholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),u("div",ce,[r(U,{color:"neutral",variant:"outline",label:o(e)("column.edit.buttons.cancel"),onClick:i[3]||(i[3]=p=>d("close"))},null,8,["label"]),r(U,{type:"submit",color:"primary",loading:o(f),label:o(f)?o(e)("column.edit.buttons.saving"):o(e)("column.edit.buttons.save")},null,8,["loading","label"])])]),_:1},8,["state","schema","onSubmit"]))]),_:1},8,["title","description"])}}});export{we as default};
