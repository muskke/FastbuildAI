const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Cqz45JHq.js","./IZm275qp.js","./BruVSCWF.js","./DS-TE4M7.js","./BgHJjJs-.js","./D-6Co9ha.js","./CXUt0j5Y.js","./-Eb02sIQ.js","./Dk6FGhu1.js","./BPKB8n-W.js","./DuSMYVIA.js","./MN31c9CG.js","./CCcv9mzY.js","./BFAo_s2U.js","./Cb04SOqd.js","./VGKgjfSv.js","./zsIs7mne.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as P,ap as B,b as T,ar as z,Q as E,e as K,s as N,g as k,aJ as q,i as F,c as H,o as O,q as f,l as i,k as n,p as a,_ as j,x,v as C,h as s,R as G,U as J}from"#entry";import{_ as Q}from"./ptVgWJmt.js";import{_ as W}from"./DiYXikHi.js";import{_ as X}from"./DduSJdeS.js";import{_ as Y}from"./CB78hAg2.js";import{_ as Z}from"./CQBV3TNh.js";import{_ as ee}from"./jQG0lB_l.js";import{f as oe,g as te,h as ae}from"./zsIs7mne.js";import"./SBXBRUHh.js";import"./BxufncEB.js";import{u as se}from"./BJ10eFuk.js";import{u as le}from"./Dx01Lm3C.js";import{u as re}from"./BREwXy1w.js";import"./CgMDXot0.js";import"./CR1AS2Ry.js";import"./DVnbt8cp.js";import"./DuSMYVIA.js";import"./D6yWePie.js";import"./CuOaO1Pb.js";import"./DHFmmngs.js";import"./C3zg6GHm.js";import"./BgHJjJs-.js";import"./VGKgjfSv.js";import"./BFVs1AfH.js";import"./kRIii9yh.js";import"./Btvd554H.js";import"./MN31c9CG.js";import"./C6Y-ieo6.js";import"./BPKB8n-W.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./3UOIlTK8.js";import"./DlAUqK2U.js";import"./Dk6FGhu1.js";const ie={class:"micropage-list-container pb-5"},ce={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},ne={class:"flex items-end gap-2 md:ml-auto"},Oe=P({__name:"list",setup(de){const S=G(()=>J(()=>import("./Cqz45JHq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]),import.meta.url)),b=Q,c=j,M=W,_=B(),{t}=T(),R=z(),{hasAccessByCodes:m}=se(),D=E(),r=K("table"),h=N([]),v=k(()=>r.value?.tableApi&&r.value.tableApi.getSelectedRowModel()?.flatRows?.length||0),V=()=>r.value?.tableApi?r.value.tableApi.getSelectedRowModel()?.flatRows?.map(o=>o.original.id)||[]:[],d=k(()=>({select:t("console-common.select"),name:t("decorate.micropage.list.columns.name"),createdAt:t("console-common.createAt"),actions:t("console-common.operation")})),I=[{id:"select",header:({table:e})=>s(b,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>{e.toggleAllPageRowsSelected(!!o)},ariaLabel:"Select all"}),cell:({row:e})=>s(b,{modelValue:e.getIsSelected(),"onUpdate:modelValue":o=>{e.toggleSelected(!!o)},ariaLabel:"Select row"})},{accessorKey:"name",header:()=>s("p",{class:""},`${d.value.name}`),cell:({row:e})=>s("div",{class:"flex items-center"},[s("span",{class:"truncate font-medium"},e.original.name)])},{accessorKey:"createdAt",header:({column:e})=>{const o=e.getIsSorted();return s(c,{color:"neutral",variant:"ghost",label:d.value.createdAt,icon:o?o==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const o=e.getValue("createdAt");return s(M,{datetime:o,mode:"datetime"})}},{id:"actions",header:()=>s("p",{class:""},`${d.value.actions}`),size:120,enableSorting:!1,enableHiding:!1,cell:({row:e})=>s("div",{class:"flex items-center gap-1"},[m(["decorate-micropage:detail"])?s(c,{icon:"i-lucide-brush",color:"primary",variant:"ghost",size:"xs",label:t("decorate.micropage.list.actions.design"),onClick:()=>{R.push({path:le("decorate-micropage:detail"),query:{id:e.original.id}})}}):null,m(["decorate-micropage:update"])?s(c,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:t("console-common.edit"),onClick:()=>{y(e.original.id)}}):null,m(["decorate-micropage:delete"])?s(c,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:t("console-common.delete"),onClick:()=>{w(e.original.id)}}):null].filter(Boolean))}],{lockFn:p,isLock:$}=q(async()=>{try{const e=await ae();h.value=e||[]}catch(e){console.log("get micropage-list api error --->",e)}}),y=async e=>{await D.create(S).open({id:e}).result&&p()},w=async e=>{try{await re({title:t("console-common.confirm"),description:Array.isArray(e)?t("decorate.micropage.list.batchDeleteMessage"):t("decorate.micropage.list.confirmDeleteMessage"),color:"error",confirmText:t("console-common.delete"),cancelText:t("console-common.cancel")});let o;Array.isArray(e)?o=await oe({ids:e}):o=await te(e),o?.success?(p(),r.value?.tableApi?.resetRowSelection(),_.success(t("console-common.messages.success"))):_.error(o?.message||t("console-common.messages.failed"))}catch(o){console.error("删除失败:",o)}};return F(()=>p()),(e,o)=>{const A=X,u=Y,L=Z,U=ee;return O(),H("div",ie,[f("div",ce,[o[2]||(o[2]=f("div",{class:"itemc-end flex justify-end"},null,-1)),f("div",ne,[i(u,{codes:["decorate-micropage:delete"]},{default:n(()=>[i(a(c),{color:"error",variant:"subtle",label:a(t)("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:!a(v),onClick:o[0]||(o[0]=()=>{const l=V();l&&l.length>0&&w(l)})},{trailing:n(()=>[i(A,null,{default:n(()=>[x(C(a(v)),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),i(L,{items:a(r)?.tableApi?.getAllColumns().filter(l=>l.getCanHide()).map(l=>({label:a(d)[l?.id]||l.columnDef.header,type:"checkbox",checked:l.getIsVisible(),onUpdateChecked(g){a(r)?.tableApi?.getColumn(l.id)?.toggleVisibility(!!g)},onSelect(g){g?.preventDefault()}})),content:{align:"end"}},{default:n(()=>[i(a(c),{label:a(t)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),i(u,{codes:["decorate-micropage:create"]},{default:n(()=>[i(a(c),{icon:"i-heroicons-plus",color:"primary",onClick:o[1]||(o[1]=l=>y(null))},{default:n(()=>[x(C(a(t)("decorate.micropage.list.addMicropage")),1)]),_:1})]),_:1})])]),i(U,{loading:a($),data:a(h),columns:I,class:"shrink-0",ref_key:"table",ref:r,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},null,8,["loading","data"])])}}});export{Oe as default};
