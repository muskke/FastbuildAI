import{_ as I}from"./DgGUMMr3.js";import{_ as k}from"./DS-TE4M7.js";import{_ as B}from"./CTGUoxQr.js";import{_ as D}from"./5XG8SC4l.js";import{aC as q,aB as G,d as N,b as z,ap as E,f as u,w as f,g as w,i as O,c as j,o as H,q as g,v as d,p as e,l as i,k as n,_ as J,x as C}from"#entry";import{_ as K}from"./CB78hAg2.js";import{_ as Q}from"./D-6Co9ha.js";import{c as W,b as v,e as X,d as Y}from"./BUyfW8JT.js";import"./ptVgWJmt.js";import"./CgMDXot0.js";import"./CR1AS2Ry.js";import"./DVnbt8cp.js";import"./DuSMYVIA.js";import"./D6yWePie.js";import"./CuOaO1Pb.js";import"./DHFmmngs.js";import"./C3zg6GHm.js";import"./BgHJjJs-.js";import"./DaWZu8wl.js";const Z=()=>q("/users/login-settings"),ee=b=>G("/users/login-settings",b),te={class:"p-2"},oe={class:"text-lg font-semibold"},le={class:"p-4"},se={class:"flex space-x-3 pt-4"},ve=N({__name:"index",setup(b){const{t}=z(),x=E(),s=u({allowedLoginMethods:[1,3],allowedRegisterMethods:[1,3],defaultLoginMethod:1,allowMultipleLogin:!1,showPolicyAgreement:!0}),a=u({allowedLoginMethods:["1","3"],allowedRegisterMethods:["1","3"],defaultLoginMethod:"1"}),p=u(null),c=u(null);f(()=>a.value.allowedLoginMethods,l=>{s.value.allowedLoginMethods=l.map(o=>parseInt(o))}),f(()=>a.value.allowedRegisterMethods,l=>{s.value.allowedRegisterMethods=l.map(o=>parseInt(o))}),f(()=>a.value.defaultLoginMethod,l=>{s.value.defaultLoginMethod=parseInt(l)});const S=W({allowedLoginMethods:Y().min(1,t("system.website.loginConfig.loginType.description")),defaultLoginMethod:X().required(t("system.website.loginConfig.defaultLoginType.description")),allowMultipleLogin:v().required(t("system.website.loginConfig.allowMultipleLogin.description")),showPolicyAgreement:v().required(t("system.website.loginConfig.isAgreement.description"))}),T=w(()=>[{value:"1",label:t("system.website.loginConfig.registerType.items.account")},{value:"3",label:t("system.website.loginConfig.registerType.items.weixin")}]),h=w(()=>[{value:"1",label:t("system.website.loginConfig.loginType.items.account"),disabled:s.value.defaultLoginMethod===1},{value:"3",label:t("system.website.loginConfig.loginType.items.weixin"),disabled:s.value.defaultLoginMethod===3}]),V=w(()=>{const l=[];return h.value.forEach(o=>{s.value.allowedLoginMethods.includes(Number(o.value))&&l.push(o)}),l}),U=()=>{$()},R=()=>{p.value&&c.value&&(s.value={...p.value},a.value={...c.value})},y=async()=>{try{const l=await Z();p.value={...l},c.value={allowedLoginMethods:l.allowedLoginMethods.map(o=>o.toString()),allowedRegisterMethods:l.allowedRegisterMethods.map(o=>o.toString()),defaultLoginMethod:l.defaultLoginMethod.toString()},s.value=l,a.value={allowedLoginMethods:l.allowedLoginMethods.map(o=>o.toString()),allowedRegisterMethods:l.allowedRegisterMethods.map(o=>o.toString()),defaultLoginMethod:l.defaultLoginMethod.toString()}}catch(l){console.error("获取登录设置失败:",l)}},$=async()=>{try{await ee(s.value),y(),x.success(t("system.website.loginConfig.updateSuccess"))}catch(l){console.error("更新登录设置失败:",l)}};return O(()=>{y()}),(l,o)=>{const M=I,m=k,A=B,_=D,L=J,F=K,P=Q;return H(),j("div",te,[g("div",null,[g("h2",oe,d(e(t)("system.website.loginConfig.title")),1)]),g("div",le,[i(P,{state:e(s),schema:e(S),class:"space-y-6",onSubmit:U},{default:n(()=>[i(m,{name:"allowedRegisterMethods",label:e(t)("system.website.loginConfig.registerType.label"),help:e(t)("system.website.loginConfig.registerType.description"),ui:{root:"flex items-start gap-4",label:"w-24 text-right mt-1",container:"flex-1"}},{label:n(()=>[g("span",null,d(e(t)("system.website.loginConfig.registerType.label")),1)]),default:n(()=>[i(M,{modelValue:e(a).allowedRegisterMethods,"onUpdate:modelValue":o[0]||(o[0]=r=>e(a).allowedRegisterMethods=r),items:e(T),orientation:"horizontal",ui:{fieldset:"space-x-4"}},null,8,["modelValue","items"])]),_:1},8,["label","help"]),i(m,{name:"allowedLoginMethods",label:e(t)("system.website.loginConfig.loginType.label"),help:e(t)("system.website.loginConfig.loginType.description"),ui:{root:"flex items-start gap-4",label:"w-24 text-right mt-1",container:"flex-1"}},{label:n(()=>[o[5]||(o[5]=g("span",{class:"mr-1 text-red-500"},"*",-1)),g("span",null,d(e(t)("system.website.loginConfig.loginType.label")),1)]),default:n(()=>[i(M,{modelValue:e(a).allowedLoginMethods,"onUpdate:modelValue":o[1]||(o[1]=r=>e(a).allowedLoginMethods=r),items:e(h),orientation:"horizontal",ui:{fieldset:"space-x-4"}},null,8,["modelValue","items"])]),_:1},8,["label","help"]),i(m,{name:"defaultLoginMethod",label:e(t)("system.website.loginConfig.defaultLoginType.label"),help:e(t)("system.website.loginConfig.defaultLoginType.description"),ui:{root:"flex items-start gap-4",label:"w-24 text-right mt-1",container:"flex-1"}},{label:n(()=>[o[6]||(o[6]=g("span",{class:"mr-1 text-red-500"},"*",-1)),g("span",null,d(e(t)("system.website.loginConfig.defaultLoginType.label")),1)]),default:n(()=>[i(A,{modelValue:e(a).defaultLoginMethod,"onUpdate:modelValue":o[2]||(o[2]=r=>e(a).defaultLoginMethod=r),items:e(V),orientation:"horizontal",ui:{fieldset:"space-x-4"}},null,8,["modelValue","items"])]),_:1},8,["label","help"]),i(m,{name:"allowMultipleLogin",label:e(t)("system.website.loginConfig.isSimultaneouslyOnline.label"),help:e(t)("system.website.loginConfig.isSimultaneouslyOnline.description"),ui:{root:"flex items-start gap-4",label:"w-24 text-right mt-1",container:"flex-1"}},{default:n(()=>[i(_,{modelValue:e(s).allowMultipleLogin,"onUpdate:modelValue":o[3]||(o[3]=r=>e(s).allowMultipleLogin=r),label:e(s).allowMultipleLogin?e(t)("system.website.loginConfig.open"):e(t)("system.website.loginConfig.close")},null,8,["modelValue","label"])]),_:1},8,["label","help"]),i(m,{name:"showPolicyAgreement",label:e(t)("system.website.loginConfig.isAgreement.label"),help:e(t)("system.website.loginConfig.isAgreement.description"),ui:{root:"flex items-start gap-4",label:"w-24 text-right mt-1",container:"flex-1"}},{default:n(()=>[i(_,{modelValue:e(s).showPolicyAgreement,"onUpdate:modelValue":o[4]||(o[4]=r=>e(s).showPolicyAgreement=r),label:e(s).showPolicyAgreement?e(t)("system.website.loginConfig.open"):e(t)("system.website.loginConfig.close")},null,8,["modelValue","label"])]),_:1},8,["label","help"]),g("div",se,[i(F,{codes:["system-website:setConfig"]},{default:n(()=>[i(L,{type:"submit",color:"primary"},{default:n(()=>[C(d(e(t)("system.website.actions.save")),1)]),_:1})]),_:1}),i(L,{type:"reset",color:"neutral",variant:"outline",onClick:R},{default:n(()=>[C(d(e(t)("system.website.actions.reset")),1)]),_:1})])]),_:1},8,["state","schema"])])])}}});export{ve as default};
