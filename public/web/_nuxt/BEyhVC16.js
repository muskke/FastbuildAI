const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D1x5an2H.js","./DBjGnECu.js","./CDmbk8fH.js","./Brvl6ix_.js","./BYK_1AlN.js","./BJ_E6Ph7.js","./DSMB-qMT.js","./b-_TUx9i.js","./B22A-h4k.js","./Cfcu-t3n.js","./B128ot1i.js","./CoMGTw2w.js","./CP4Zo7YT.js","./XpsTG8vq.js","./B1gVa3Y2.js","./B93AZ-4h.js"])))=>i.map(i=>d[i]);
import{d as j,b as q,aq as E,Q as G,s as Q,aM as H,h as S,_ as Y,f as J,g as W,w as X,i as Z,c as y,o as u,q as n,F as ee,B as oe,l as i,k as m,v as d,p as e,t as te,x as V,j as w,A as ae,R as re,C as ne,U as se}from"#entry";import{_ as le}from"./DBjGnECu.js";import{_ as ie}from"./B1Lg5z9T.js";import{_ as de}from"./DZPTBo-g.js";import ce from"./--UdezPG.js";import{_ as me}from"./EHoVw6ZP.js";import{_ as ue}from"./CBooyAK7.js";import{_ as pe}from"./Brvl6ix_.js";import{_ as ge}from"./DgnnKcyj.js";import{b as fe,c as he,a as ye}from"./B1gVa3Y2.js";import{u as be}from"./Dp_0VxUw.js";import{u as _e}from"./FihYtau-.js";import{u as ve}from"./B93AZ-4h.js";import"./CLTNKp0S.js";import"./8-c-A7PB.js";import"./kRIii9yh.js";import"./TH-3OOuG.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Cpt2kRVT.js";import"./pUN2d83w.js";import"./B22A-h4k.js";import"./Bub1HYiY.js";import"./lw_U4-W2.js";import"./XpsTG8vq.js";import"./DN9ov8OT.js";import"./BstbYvQo.js";import"./DlAUqK2U.js";const ke={class:"flex h-full flex-col space-y-4 pb-6"},xe={class:"grid grid-cols-2 gap-4 pt-px md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"},Se={class:"flex items-center justify-center"},Ve={class:"flex flex-col items-center"},we={class:"text-2xl font-bold"},Ae={class:"text-muted-foreground ml-1 text-xs"},Ce={class:"text-muted-foreground text-xs"},Ue={class:"flex flex-1 flex-col overflow-hidden"},Re={class:"h-fit py-5"},Ie={class:"flex items-center space-x-2"},Te={class:"flex flex-col items-start"},Ne={class:"flex flex-col items-center"},Oe={key:0,class:"text-muted-foreground mb-1 flex justify-center text-xs font-medium"},ze={class:"border-default mt-auto flex items-center justify-between gap-3 border-t pt-4"},Pe={class:"text-muted flex items-center gap-2 text-sm"},Be={class:"flex items-center gap-1.5"},De={class:"text-muted flex items-center gap-2 text-sm"},yo=j({__name:"order-recharge",setup(Ke){const A=re(()=>se(()=>import("./D1x5an2H.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),C=le,b=Y,U=ie,{t:o}=q(),{hasAccessByCodes:_}=be(),R=E(),I=G(),v=Q({totalAmount:0,totalIncome:0,totalOrder:0,totalRefundAmount:0,totalRefundOrder:0}),T=[{key:"totalOrder",unit:"console-common.unit",label:"order.backend.recharge.rechargeCount"},{key:"totalAmount",unit:"console-common.yuan",label:"order.backend.recharge.totalRechargeAmount"},{key:"totalRefundOrder",unit:"console-common.unit",label:"order.backend.recharge.refundCount"},{key:"totalRefundAmount",unit:"console-common.yuan",label:"order.backend.recharge.totalRefundAmount"},{key:"totalIncome",unit:"console-common.yuan",label:"order.backend.recharge.netIncome"}],s=H({keyword:"",orderNo:"",payType:void 0,payStatus:void 0,refundStatus:void 0}),{paging:l,getLists:c,resetPage:N}=_e({fetchFun:fe,params:s}),O=[{accessorKey:"orderNo",header:o("order.backend.recharge.list.orderNo")},{accessorKey:"user",header:o("order.backend.recharge.list.user")},{accessorKey:"power",header:o("order.backend.recharge.list.rechargeQuantity")},{accessorKey:"givePower",header:o("order.backend.recharge.list.freeQuantity")},{accessorKey:"totalPower",header:o("order.backend.recharge.list.quantityReceived")},{accessorKey:"orderAmount",header:o("order.backend.recharge.list.paidInAmount"),cell:({row:r})=>{const a=Number.parseFloat(r.getValue("orderAmount"));return new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(a)}},{accessorKey:"payTypeDesc",header:o("order.backend.recharge.list.paymentMethod")},{accessorKey:"paymentStatus",header:o("order.backend.recharge.list.paymentStatus")},{accessorKey:"createdAt",header:({column:r})=>{const a=r.getIsSorted();return S(b,{color:"neutral",variant:"ghost",label:o("order.backend.recharge.list.createdAt"),icon:a?a==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>r.toggleSorting(r.getIsSorted()==="asc")})},cell:({row:r})=>{const a=r.getValue("createdAt");return S(C,{datetime:a,mode:"datetime"})}},{accessorKey:"actions",header:()=>o("order.backend.recharge.list.actions"),size:40,enableSorting:!1,enableHiding:!0}],z=async r=>{await ve({title:o("order.backend.recharge.list.refund"),description:o("console-common.confirmRefund"),color:"warning"}),await ye(r||""),c(),R.success(o("console-common.refundSuccess"))};function P(r){return[_(["recharge-order:detail"])?{label:o("order.backend.recharge.list.viewDetails"),icon:"i-lucide-eye",color:"info",onClick:()=>{D(r.original.id)}}:null,r.original.payStatus===1&&_(["recharge-order:refund"])&&r.original.refundStatus===0?{label:o("order.backend.recharge.list.refund"),icon:"tabler:arrow-back",color:"error",onSelect(){z(r.original.id)}}:null].filter(Boolean)}const g=J({left:[],right:["actions"]}),B=W(()=>{const r=l.extend?.payTypeLists||[];return[{label:o("console-common.all"),value:"all"},...r.map(a=>({label:a.name,value:a.payType}))]});X(()=>l.extend,r=>{r?.statistics&&(v.value=r.statistics)},{deep:!0});const D=async r=>{if(r)try{const a=await he(r);K(a)}catch(a){console.error(a)}},K=r=>{I.create(A).open({order:r,"onGet-list":()=>{c()},onClose:()=>{}})},f=()=>{s.payType==="all"&&(s.payType=void 0),s.payStatus==="all"&&(s.payStatus=void 0),s.refundStatus==="all"&&(s.refundStatus=void 0),N()};return Z(()=>c()),(r,a)=>{const k=de,h=ce,p=me,x=ne,$=ue,M=pe,F=ge;return u(),y("div",ke,[n("div",xe,[(u(),y(ee,null,oe(T,(t,L)=>i(k,{key:L},{default:m(()=>[n("div",Se,[n("div",Ve,[n("div",null,[n("span",we,d(e(v)[t.key]),1),n("span",Ae,d(e(o)(t.unit)),1)]),n("div",Ce,d(e(o)(t.label)),1)])])]),_:2},1024)),64))]),n("div",Ue,[n("div",Re,[n("div",Ie,[i(h,{placeholder:e(o)("order.backend.recharge.list.searchOrderNo"),icon:"i-heroicons-magnifying-glass",modelValue:e(s).orderNo,"onUpdate:modelValue":[a[0]||(a[0]=t=>e(s).orderNo=t),e(c)]},null,8,["placeholder","modelValue","onUpdate:modelValue"]),i(h,{placeholder:e(o)("order.backend.recharge.list.searchUser"),icon:"i-heroicons-magnifying-glass",modelValue:e(s).keyword,"onUpdate:modelValue":[a[1]||(a[1]=t=>e(s).keyword=t),e(c)]},null,8,["placeholder","modelValue","onUpdate:modelValue"]),i(p,{class:"ml-auto",placeholder:e(o)("order.backend.recharge.list.paymentMethod"),items:e(B),modelValue:e(s).payType,"onUpdate:modelValue":[a[2]||(a[2]=t=>e(s).payType=t),f]},null,8,["placeholder","items","modelValue"]),i(p,{placeholder:e(o)("order.backend.recharge.list.paymentStatus"),items:[{label:e(o)("console-common.all"),value:"all"},{label:e(o)("order.backend.recharge.list.paid"),value:"1"},{label:e(o)("order.backend.recharge.list.unpaid"),value:"0"}],modelValue:e(s).payStatus,"onUpdate:modelValue":[a[3]||(a[3]=t=>e(s).payStatus=t),f]},null,8,["placeholder","items","modelValue"]),i(p,{placeholder:e(o)("order.backend.recharge.list.refundStatus"),items:[{label:e(o)("console-common.all"),value:"all"},{label:e(o)("order.backend.recharge.list.refunded"),value:"1"},{label:e(o)("order.backend.recharge.list.notRefunded"),value:"0"}],modelValue:e(s).refundStatus,"onUpdate:modelValue":[a[4]||(a[4]=t=>e(s).refundStatus=t),f]},null,8,["placeholder","items","modelValue"])])]),i(M,{ref:"table",sticky:"",data:e(l).items,loading:e(l).loading,columns:O,"column-pinning":e(g),"onUpdate:columnPinning":a[5]||(a[5]=t=>ae(g)?g.value=t:null),ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"},class:""},{"user-cell":m(({row:t})=>[t.original.user?.avatar?(u(),w(x,{key:0,src:t.original.user?.avatar},null,8,["src"])):(u(),w(x,{key:1,icon:"i-heroicons-user",name:t.original.user?.username},null,8,["name"])),V(" "+d(t.original.user?.username),1)]),"paymentStatus-cell":m(({row:t})=>[n("div",Te,[n("div",Ne,[t.original.refundStatus===1?(u(),y("div",Oe,d(e(o)("order.backend.recharge.list.paid")),1)):te("",!0),i($,{color:t.original.refundStatus===1?"warning":t.original.payStatus===1?"success":"error"},{default:m(()=>[V(d(t.original.refundStatus===1?e(o)("order.backend.recharge.list.refunded"):t.original.payStatus===1?e(o)("order.backend.recharge.list.paid"):e(o)("order.backend.recharge.list.unpaid")),1)]),_:2},1032,["color"])])])]),"actions-cell":m(({row:t})=>[i(e(U),{items:P(t)},{default:m(()=>[i(e(b),{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost","aria-label":"Actions"})]),_:1},8,["items"])]),_:1},8,["data","loading","column-pinning"]),n("div",ze,[n("div",Pe,[n("span",null,d(e(o)("console-common.total"))+" "+d(e(l).total)+" "+d(e(o)("console-common.items")),1),i(p,{modelValue:e(l).pageSize,"onUpdate:modelValue":a[6]||(a[6]=t=>e(l).pageSize=t),size:"lg",items:[{label:"10 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:10},{label:"20 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:20},{label:"50 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:50},{label:"100 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:100}],class:"w-28",onChange:e(c)},null,8,["modelValue","items","onChange"])]),n("div",Be,[i(F,{page:e(l).page,"onUpdate:page":a[7]||(a[7]=t=>e(l).page=t),size:e(l).pageSize,"onUpdate:size":a[8]||(a[8]=t=>e(l).pageSize=t),"show-edges":"",total:e(l).total,onChange:e(c)},null,8,["page","size","total","onChange"]),n("div",De,[n("span",null,d(e(o)("console-common.goTo")),1),i(h,{modelValue:e(l).page,"onUpdate:modelValue":a[9]||(a[9]=t=>e(l).page=t),size:"lg",type:"number",class:"w-18",onChange:e(c)},null,8,["modelValue","onChange"]),n("span",null,d(e(o)("console-common.page")),1)])])])])])}}});export{yo as default};
