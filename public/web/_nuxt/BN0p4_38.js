const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./G73pcGKJ.js","./YsC0FLg2.js","./CqN3ElKI.js","./--UdezPG.js","./BaNg8fjw.js","./DlAUqK2U.js","./ZZC6mEJB.js","./BgHJjJs-.js","./DN9ov8OT.js","./nBDBqKnC.js","./BYwSSEjb.js","./JOupiI7i.js","./PB-3MFNY.js","./TH-3OOuG.js","./B22A-h4k.js","./b-_TUx9i.js","./Cv1u6XyE.js","./CKTa8Hyi.js","./8-c-A7PB.js","./kRIii9yh.js","./CKXZhss7.js","./pUN2d83w.js","./Cfcu-t3n.js","./Bu7cOM_l.js","./DAQypLay.js","./EHoVw6ZP.js","./DaNf1Wdt.js","./BstbYvQo.js","./DNgvVYsj.js","./C_EXknkZ.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as U,b as C,aJ as D,au as R,aq as w,g as x,f as I,aK as B,i as F,c as b,o as u,q as m,j as L,l as p,k as S,y as $,v as k,p as t,_ as j,R as q,U as E,bN as N,bO as T}from"#entry";import{g as V}from"./C_EXknkZ.js";const z={class:"user-edit-container"},G={class:"bg-background sticky top-0 z-10 mb-4 flex w-full items-center justify-baseline pb-2"},M={class:"text-base font-medium"},O={class:"ml-4 text-xl font-bold"},P={key:0,class:"flex justify-center py-12"},Q=U({__name:"edit",setup(J){const g=q(()=>E(()=>import("./G73pcGKJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url)),{t:n}=C(),h=D(),a=R(),r=w(),i=x(()=>h.query.id),_=I({}),{lockFn:f,isLock:y}=B(async()=>{if(!i.value){r.error(n("user.backend.messages.missingUserId")),a.back();return}try{const{id:e,createdAt:s,updatedAt:c,lastLoginAt:d,role:l,...o}=await N(i.value);o.phone||(o.phoneAreaCode=V()),_.value={...o,roleId:l?.id||void 0}}catch(e){console.error("Get user detail failed:",e),r.error(n("user.backend.messages.getUserDetailFailed")),a.back()}}),v=async e=>{try{const{username:s,password:c,isRoot:d,totalRechargeAmount:l,...o}=e;await T(i.value,o),r.success(n("user.backend.messages.updateSuccess")),setTimeout(()=>a.back(),1e3)}catch(s){console.error("Update user failed:",s),r.error(n("user.backend.messages.updateFailed"))}},A=()=>{a.back()};return F(()=>f()),(e,s)=>{const c=$,d=j;return u(),b("div",z,[m("div",G,[p(d,{color:"neutral",variant:"soft",onClick:s[0]||(s[0]=l=>t(a).back())},{default:S(()=>[p(c,{name:"i-lucide-arrow-left",class:"size-5 cursor-pointer"}),m("span",M,k(e.$t("console-common.back")),1)]),_:1}),m("h1",O,k(e.$t("user.backend.editTitle")),1)]),t(y)?(u(),b("div",P,[p(c,{name:"i-lucide-loader-2",class:"text-primary-500 h-8 w-8 animate-spin"})])):(u(),L(t(g),{key:1,"is-edit":!0,id:t(i),"initial-data":t(_),onRefresh:t(f),onSubmitSuccess:v,onCancel:A},null,8,["id","initial-data","onRefresh"]))])}}});export{Q as default};
