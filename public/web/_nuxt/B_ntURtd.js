const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BtLDamHb.js","./BruVSCWF.js","./IZm275qp.js","./Cif_tCX1.js","./CXUt0j5Y.js","./-Eb02sIQ.js","./Dk6FGhu1.js","./BPKB8n-W.js","./DuSMYVIA.js","./MN31c9CG.js","./CCcv9mzY.js","./BFAo_s2U.js","./Cb04SOqd.js","./VGKgjfSv.js","./DyY5B2r8.js","./BREwXy1w.js","./Dg73AsSw.js","./DiYXikHi.js","./Bc8dz9M9.js","./COxNVqQJ.js","./C7UmhjTd.js","./BFVs1AfH.js","./DHFmmngs.js","./kRIii9yh.js","./Btvd554H.js","./C6Y-ieo6.js","./B-DdbQ-X.js","./V9POJiZu.js","./CuOaO1Pb.js","./D6yWePie.js","./3UOIlTK8.js","./Dx01Lm3C.js","./Orh0Bn2C.js","./5XG8SC4l.js","./BgHJjJs-.js","./CR1AS2Ry.js","./C3zg6GHm.js","./DS-TE4M7.js","./Dg6D3RQ3.js","./BZ3-JWpk.js","./ql0_WxJN.js","./BdImEx5p.js","./oFTPHjuc.js","./BcsO9TDZ.js","./DlAUqK2U.js","./ChM0pAjz.js","./UqhBTNL6.js","./lbUBlloI.js","./D-6Co9ha.js","./BUyfW8JT.js","./DaWZu8wl.js","./BIwjuh_U.js","./-yQodR3K.js","./DUgjrvZa.js","./BxufncEB.js","./COpGcmQf.js","./ybFaAORl.js","./DVnbt8cp.js"])))=>i.map(i=>d[i]);
import{d as J,Q as K,s as x,w as q,aR as oe,j as U,o as c,k as D,r as se,l,_ as W,c as k,t as P,y as X,p as o,v as $,q as n,A as Q,F as Y,B as Z,x as le,R as S,U as C,ap as ne,b as ie,au as re,i as ce,n as N}from"#entry";import ee from"./BruVSCWF.js";import{_ as de}from"./COxNVqQJ.js";import{_ as ue}from"./C7UmhjTd.js";import{a as me}from"./DyY5B2r8.js";import{_ as pe}from"./CRoF6I1E.js";import{_ as ge}from"./C1MVswYH.js";import{_ as fe}from"./i5AwkGQh.js";import{u as H,v as _e,w as he,x as ve,y as ye}from"./ChM0pAjz.js";import{u as be}from"./BREwXy1w.js";import"./BFVs1AfH.js";import"./DHFmmngs.js";import"./kRIii9yh.js";import"./Btvd554H.js";import"./MN31c9CG.js";import"./C6Y-ieo6.js";import"./BPKB8n-W.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./CuOaO1Pb.js";import"./D6yWePie.js";import"./DuSMYVIA.js";import"./3UOIlTK8.js";import"./CR1AS2Ry.js";import"./BstbYvQo.js";import"./BcsO9TDZ.js";import"./DlAUqK2U.js";const we={key:0,class:"text-sm"},ke={key:1,class:"text-dimmed flex-none text-sm"},$e={class:"flex flex-col gap-2 p-2"},xe={key:0,class:"flex flex-col gap-1"},Te={key:1,class:"flex h-30 flex-col items-center justify-center gap-2"},Ve={class:"text-muted text-sm"},Ie=J({__name:"tag-select",props:{modelValue:{default:()=>[]},type:{default:"app"}},emits:["update:modelValue","change","close"],setup(G,{emit:z}){const M=S(()=>C(()=>import("./BtLDamHb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),T=z,R=G,p=oe(R,"modelValue",T),E=K(),g=x([]),i=x([]),t=x(""),r=x(!1),_=async()=>{const a=await me({type:R.type});g.value=a,L()},V=a=>{i.value.includes(a)?i.value=i.value.filter(u=>u.id!==a.id):i.value.push(a),p.value=i.value.map(u=>u.id),T("change",a)},d=async()=>{await E.create(M).open({type:R.type}).result,await _()},L=()=>{if(!g.value?.length){i.value=[];return}i.value=g.value.filter(a=>p.value?.includes(a.id))},B=()=>{p.value=[],i.value=[],T("change",[])};return q(()=>p.value,()=>{L()},{deep:!1}),q(r,a=>{a?_():T("close")}),(a,u)=>{const I=X,A=W,O=ee,j=de,F=ue;return c(),U(F,{open:o(r),"onUpdate:open":u[1]||(u[1]=f=>Q(r)?r.value=f:null),content:{align:"center",side:"bottom",sideOffset:8}},{content:D(()=>[n("div",$e,[l(O,{modelValue:o(t),"onUpdate:modelValue":u[0]||(u[0]=f=>Q(t)?t.value=f:null),placeholder:a.$t("common.search"),clearable:"",icon:"i-lucide-search",variant:"soft",color:"neutral",ui:{root:"w-full",base:"w-full",trailing:"pr-1"}},null,8,["modelValue","placeholder"]),n("div",null,[o(g).length>0?(c(),k("div",xe,[(c(!0),k(Y,null,Z(o(g),f=>(c(),U(A,{key:f.id,color:"neutral",variant:"ghost",ui:{base:"justify-between"},onClick:e=>V(f)},{default:D(()=>[le($(f.name)+" ",1),o(p).includes(f.id)?(c(),U(I,{key:0,name:"i-lucide-check",class:"size-4"})):P("",!0)]),_:2},1032,["onClick"]))),128))])):P("",!0),o(g).length===0?(c(),k("div",Te,[l(I,{name:"i-lucide-tags",class:"size-5"}),n("span",Ve,$(a.$t("common.tag.noTags")),1)])):P("",!0)]),l(j,{type:"dashed"}),n("div",null,[l(A,{label:a.$t("common.tag.manageTags"),color:"neutral",variant:"ghost",icon:"i-lucide-tags",ui:{base:"w-full"},onClick:d},null,8,["label"])])])]),default:D(()=>[se(a.$slots,"trigger",{},()=>[l(A,{color:"neutral",variant:"outline",ui:{base:"gap-2"}},{default:D(()=>[l(I,{name:"i-lucide-tag",class:"size-4"}),o(p).length>0?(c(),k("span",we,$(o(p).length)+$(a.$t("common.tag.tags")),1)):(c(),k("span",ke,$(a.$t("common.tag.allTags")),1)),o(p).length>0?(c(),U(A,{key:2,color:"neutral",variant:"soft",icon:"i-lucide-x",size:"xs",onClick:B})):P("",!0),l(I,{name:"i-lucide-chevron-down",class:"text-dimmed size-4 shrink-0"})]),_:1})])]),_:3},8,["open"])}}}),Ae={class:"flex w-full flex-col items-center justify-center"},Se={class:"bg-background sticky top-0 z-10 flex w-full flex-wrap justify-between gap-4 pb-2"},Ce={class:"flex items-center gap-4"},De={class:"grid grid-cols-1 gap-6 pt-2 pb-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Re={class:"group-hover:text-primary text-foreground mb-3 flex items-center gap-3"},Ue={class:"border-default flex size-10 flex-none items-center justify-center rounded-lg border border-dashed"},Ee={class:"truncate text-sm font-medium"},Le={class:"text-muted-foreground mb-6 pr-8 text-xs"},Pe={class:"line-clamp-2 overflow-hidden"},ze={class:"flex items-center gap-2"},ut=J({__name:"list",setup(G){const z=S(()=>C(()=>import("./Dg73AsSw.js"),__vite__mapDeps([16,2,3,17,18,1,19,20,21,22,23,24,9,25,7,26,27,28,29,8,30,14,31]),import.meta.url)),M=S(()=>C(()=>import("./Orh0Bn2C.js"),__vite__mapDeps([32,33,2,34,35,36,37,1,38,39,4,5,6,7,8,9,10,11,12,13,40,41,42,43,44,45,46]),import.meta.url)),T=S(()=>C(()=>import("./lbUBlloI.js"),__vite__mapDeps([47,2,37,34,40,1,41,42,43,44,38,48,4,5,6,7,8,9,10,11,12,13,45,49,50,51,31]),import.meta.url)),R=S(()=>C(()=>import("./-yQodR3K.js"),__vite__mapDeps([52,2,1,3,53,11,6,7,8,9,54,45,44]),import.meta.url)),p=S(()=>C(()=>import("./COpGcmQf.js"),__vite__mapDeps([55,56,2,22,8,28,29,57,3,40,1,41,42,43,44,37,34,4,5,6,7,9,10,11,12,13,45]),import.meta.url)),E=ne(),{t:g}=ie(),i=K(),t=re({keyword:"",page:1,pageSize:15,tagIds:[],isPublic:void 0}),r=x(!1),_=x(!0),V=x([]),d=async()=>{if(!r.value){r.value=!0,t.page=1;try{const e=await H(t);V.value=e.items||[],_.value=e.totalPages>t.page}catch(e){console.error("获取数据失败:",e),_.value=!1}finally{r.value=!1}}},L=async()=>{if(!(r.value||!_.value)){r.value=!0,t.page!==void 0&&t.page++;try{const e=await H(t);e.items&&e.items.length>0?(V.value.push(...e.items),_.value=e.totalPages>(t.page||0)):_.value=!1}catch(e){t.page!==void 0&&t.page--,console.error("加载更多数据失败:",e)}finally{r.value=!1}}},B=async e=>{try{await be({title:g("console-common.delete"),description:g("ai-agent.backend.desc.delete"),color:"error"}),await _e(e.id);const s=t.page;t.page=1,t.pageSize=V.value.length,await d(),t.page=s,t.pageSize=15,E.success(g("common.message.deleteSuccess"))}catch(s){console.error("删除失败:",s)}},a=async(e=null)=>{await i.create(T).open({id:e}).result&&(t.page=1,t.pageSize=15,await d())},u=async()=>{const e=i.create(R);await e.open().result&&(t.page=1,t.pageSize=15,await d()),e.open()},I=e=>{a(e.id)},A=()=>{a(null)},O=async e=>{try{const s=await he(e.id,"yaml"),h=new Blob([s],{type:"text/yaml;charset=utf-8"}),v=URL.createObjectURL(h),m=document.createElement("a");m.href=v,m.download=`${e.name||"agent"}.yaml`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(v),E.success("DSL 文件导出成功！")}catch(s){console.error("导出 DSL 失败:",s)}},j=async()=>{await i.create(p).open().result&&(t.page=1,t.pageSize=15,await d())},F=async(e,s)=>{const h=e.tags?.map(w=>w.id)??[],v=s,m=v.filter(w=>!h.includes(w)),b=h.filter(w=>!v.includes(w));m.length===0&&b.length===0||(m.length>0&&await ve(e.id,m),b.length>0&&await ye(e.id,b),await d())},f=async()=>{i.create(M).open()};return ce(()=>d()),(e,s)=>{const h=ee,v=Ie,m=pe,b=W,w=X,te=ge,ae=fe;return c(),k("div",Ae,[n("div",Se,[n("div",Ce,[l(h,{modelValue:o(t).keyword,"onUpdate:modelValue":s[0]||(s[0]=y=>o(t).keyword=y),placeholder:e.$t("ai-agent.backend.search.placeholder"),class:"w-80",onChange:d},null,8,["modelValue","placeholder"]),l(v,{modelValue:o(t).tagIds,"onUpdate:modelValue":s[1]||(s[1]=y=>o(t).tagIds=y),onChange:d},null,8,["modelValue"]),l(m,{modelValue:o(t).isPublic,"onUpdate:modelValue":s[2]||(s[2]=y=>o(t).isPublic=y),items:[{label:e.$t("ai-agent.backend.search.allStatus"),value:void 0},{label:e.$t("ai-agent.backend.configuration.public"),value:!0},{label:e.$t("ai-agent.backend.configuration.private"),value:!1}],placeholder:e.$t("ai-agent.backend.search.filterByStatus"),"label-key":"label","value-key":"value",class:"w-48",onChange:d},null,8,["modelValue","items","placeholder"])]),n("div",null,[l(b,{color:"primary",variant:"ghost",icon:"i-lucide-package",label:e.$t("decorate.openDecorateSettings"),onClick:N(f,["stop"])},null,8,["label"])])]),l(ae,{class:"h-[calc(100vh-9rem)] min-h-0 w-full"},{default:D(()=>[l(te,{loading:o(r),"has-more":o(_),threshold:200,"loading-text":e.$t("common.loading"),"no-more-text":o(t).page!==1?e.$t("common.noMoreData"):" ",onLoadMore:L},{default:D(()=>[n("div",De,[n("div",{class:"group border-default relative cursor-pointer rounded-lg border border-dashed p-4 transition-all duration-200 hover:shadow-lg",onClick:A},[n("div",Re,[n("div",Ue,[l(w,{name:"i-lucide-plus",class:"h-6 w-6"})]),n("h3",Ee,$(e.$t("ai-agent.backend.create.title")),1)]),n("div",Le,[n("p",Pe,$(e.$t("ai-agent.backend.create.desc")),1)]),n("div",ze,[l(b,{color:"primary",variant:"ghost",class:"w-full",icon:"i-lucide-package",size:"sm",label:e.$t("ai-agent.backend.create.fromTemplate"),onClick:N(u,["stop"])},null,8,["label"]),l(b,{color:"neutral",variant:"ghost",class:"w-full",icon:"i-lucide-file-up",size:"sm",label:e.$t("ai-agent.backend.dslImport.import"),onClick:N(j,["stop"])},null,8,["label"])])]),(c(!0),k(Y,null,Z(o(V),y=>(c(),U(o(z),{key:y.id,agent:y,onDelete:B,onEdit:I,onExportDsl:O,onUpdateTags:F},null,8,["agent"]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})])}}});export{ut as default};
