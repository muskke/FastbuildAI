const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C2tm6-TI.js","./CDmbk8fH.js","./--UdezPG.js","./BYwSSEjb.js","./BgHJjJs-.js","./DNgvVYsj.js","./BYK_1AlN.js","./BJ_E6Ph7.js","./DSMB-qMT.js","./b-_TUx9i.js","./B22A-h4k.js","./Cfcu-t3n.js","./B128ot1i.js","./CoMGTw2w.js","./CP4Zo7YT.js","./XpsTG8vq.js","./CaCT6lpU.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as P,aq as B,b as T,au as z,Q as E,e as K,s as q,g as k,aK as N,i as F,c as H,o as O,q as f,l as i,k as n,p as a,_ as j,x,v as C,h as s,R as G,U as Q}from"#entry";import{_ as J}from"./BwTGIg9g.js";import{_ as W}from"./DBjGnECu.js";import{_ as X}from"./lw_U4-W2.js";import{_ as Y}from"./CJG2iIES.js";import{_ as Z}from"./B1Lg5z9T.js";import{_ as ee}from"./Brvl6ix_.js";import{f as oe,g as te,h as ae}from"./CaCT6lpU.js";import"./Ckl3SRHu.js";import"./Di6e_Jmj.js";import{u as se}from"./Dp_0VxUw.js";import{u as le}from"./DqVgEjI6.js";import{u as re}from"./B93AZ-4h.js";import"./BWWuJQeZ.js";import"./DN9ov8OT.js";import"./9bDOsXij.js";import"./B22A-h4k.js";import"./pUN2d83w.js";import"./Cpt2kRVT.js";import"./8-c-A7PB.js";import"./nBDBqKnC.js";import"./BgHJjJs-.js";import"./XpsTG8vq.js";import"./CLTNKp0S.js";import"./kRIii9yh.js";import"./TH-3OOuG.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Bub1HYiY.js";import"./DlAUqK2U.js";import"./DSMB-qMT.js";const ie={class:"micropage-list-container pb-5"},ce={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},ne={class:"flex items-end gap-2 md:ml-auto"},Oe=P({__name:"list",setup(de){const S=G(()=>Q(()=>import("./C2tm6-TI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]),import.meta.url)),b=J,c=j,M=W,_=B(),{t}=T(),R=z(),{hasAccessByCodes:m}=se(),D=E(),r=K("table"),h=q([]),v=k(()=>r.value?.tableApi&&r.value.tableApi.getSelectedRowModel()?.flatRows?.length||0),V=()=>r.value?.tableApi?r.value.tableApi.getSelectedRowModel()?.flatRows?.map(o=>o.original.id)||[]:[],d=k(()=>({select:t("console-common.select"),name:t("decorate.micropage.list.columns.name"),createdAt:t("console-common.createAt"),actions:t("console-common.operation")})),I=[{id:"select",header:({table:e})=>s(b,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>{e.toggleAllPageRowsSelected(!!o)},ariaLabel:"Select all"}),cell:({row:e})=>s(b,{modelValue:e.getIsSelected(),"onUpdate:modelValue":o=>{e.toggleSelected(!!o)},ariaLabel:"Select row"})},{accessorKey:"name",header:()=>s("p",{class:""},`${d.value.name}`),cell:({row:e})=>s("div",{class:"flex items-center"},[s("span",{class:"truncate font-medium"},e.original.name)])},{accessorKey:"createdAt",header:({column:e})=>{const o=e.getIsSorted();return s(c,{color:"neutral",variant:"ghost",label:d.value.createdAt,icon:o?o==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const o=e.getValue("createdAt");return s(M,{datetime:o,mode:"datetime"})}},{id:"actions",header:()=>s("p",{class:""},`${d.value.actions}`),size:120,enableSorting:!1,enableHiding:!1,cell:({row:e})=>s("div",{class:"flex items-center gap-1"},[m(["decorate-micropage:detail"])?s(c,{icon:"i-lucide-brush",color:"primary",variant:"ghost",size:"xs",label:t("decorate.micropage.list.actions.design"),onClick:()=>{R.push({path:le("decorate-micropage:detail"),query:{id:e.original.id}})}}):null,m(["decorate-micropage:update"])?s(c,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:t("console-common.edit"),onClick:()=>{y(e.original.id)}}):null,m(["decorate-micropage:delete"])?s(c,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:t("console-common.delete"),onClick:()=>{w(e.original.id)}}):null].filter(Boolean))}],{lockFn:p,isLock:$}=N(async()=>{try{const e=await ae();h.value=e||[]}catch(e){console.log("get micropage-list api error --->",e)}}),y=async e=>{await D.create(S).open({id:e}).result&&p()},w=async e=>{try{await re({title:t("console-common.confirm"),description:Array.isArray(e)?t("decorate.micropage.list.batchDeleteMessage"):t("decorate.micropage.list.confirmDeleteMessage"),color:"error",confirmText:t("console-common.delete"),cancelText:t("console-common.cancel")});let o;Array.isArray(e)?o=await oe({ids:e}):o=await te(e),o?.success?(p(),r.value?.tableApi?.resetRowSelection(),_.success(t("console-common.messages.success"))):_.error(o?.message||t("console-common.messages.failed"))}catch(o){console.error("删除失败:",o)}};return F(()=>p()),(e,o)=>{const A=X,u=Y,L=Z,U=ee;return O(),H("div",ie,[f("div",ce,[o[2]||(o[2]=f("div",{class:"itemc-end flex justify-end"},null,-1)),f("div",ne,[i(u,{codes:["decorate-micropage:delete"]},{default:n(()=>[i(a(c),{color:"error",variant:"subtle",label:a(t)("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:!a(v),onClick:o[0]||(o[0]=()=>{const l=V();l&&l.length>0&&w(l)})},{trailing:n(()=>[i(A,null,{default:n(()=>[x(C(a(v)),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),i(L,{items:a(r)?.tableApi?.getAllColumns().filter(l=>l.getCanHide()).map(l=>({label:a(d)[l?.id]||l.columnDef.header,type:"checkbox",checked:l.getIsVisible(),onUpdateChecked(g){a(r)?.tableApi?.getColumn(l.id)?.toggleVisibility(!!g)},onSelect(g){g?.preventDefault()}})),content:{align:"end"}},{default:n(()=>[i(a(c),{label:a(t)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),i(u,{codes:["decorate-micropage:create"]},{default:n(()=>[i(a(c),{icon:"i-heroicons-plus",color:"primary",onClick:o[1]||(o[1]=l=>y(null))},{default:n(()=>[x(C(a(t)("decorate.micropage.list.addMicropage")),1)]),_:1})]),_:1})])]),i(U,{loading:a($),data:a(h),columns:I,class:"shrink-0",ref_key:"table",ref:r,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},null,8,["loading","data"])])}}});export{Oe as default};
