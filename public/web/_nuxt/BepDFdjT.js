import{d as N,g,aJ as V,b as j,aq as z,aM as O,aK as D,i as q,j as b,o as r,k as c,c as i,p as t,l as d,y as R,q as o,t as _,C as A,v as s,x as m,_ as G,F as J,B as K}from"#entry";import{_ as H}from"./BqoA6bN6.js";import{_ as P}from"./CBooyAK7.js";import{_ as Q}from"./BYK_1AlN.js";import{i as W,d as X,h as Y}from"./D9F45f3T.js";import"./TH-3OOuG.js";import"./Bub1HYiY.js";import"./B22A-h4k.js";import"./lw_U4-W2.js";import"./XpsTG8vq.js";import"./BJ_E6Ph7.js";import"./DSMB-qMT.js";import"./b-_TUx9i.js";import"./Cfcu-t3n.js";import"./B128ot1i.js";import"./CoMGTw2w.js";import"./CP4Zo7YT.js";const Z={key:0,class:"flex items-center justify-center",style:{height:"400px"}},tt={key:1,class:"max-h-180"},et={class:"flex justify-between pb-4"},ot={class:"flex items-center gap-4"},st={class:"text-secondary-foreground flex items-center text-base font-semibold"},at={class:"line-clamp-1"},nt={class:"bg-muted rounded-lg p-4 pb-4"},rt={class:"text-muted-foreground text-xs"},ct={class:"grid grid-cols-1 gap-x-6 gap-y-4 py-4 pb-4 md:grid-cols-2"},it={key:0},dt={class:"text-muted-foreground text-sm"},mt={class:"max-w-100"},lt={class:"text-secondary-foreground mt-1 truncate font-medium"},ut={class:"text-muted-foreground text-sm"},ft={class:"text-secondary-foreground mt-1 font-medium"},pt={key:1},_t={class:"text-muted-foreground text-sm"},xt={class:"text-secondary-foreground mt-1 font-medium"},yt={class:"text-muted-foreground text-sm"},vt={class:"text-secondary-foreground mt-1 font-medium"},ht={class:"text-muted-foreground text-sm"},gt={class:"text-secondary-foreground mt-1 font-medium"},Dt={class:"text-muted-foreground text-sm"},bt={class:"text-secondary-foreground mt-1 font-medium"},kt={class:"text-muted-foreground text-sm"},wt={key:0,class:"text-error mt-1 text-sm font-medium"},St={key:1,class:"mt-1 text-sm font-medium"},Tt={key:0,class:"pb-4"},Bt={class:"text-secondary-foreground mb-2 text-base font-medium"},Ct={class:"max-h-80 space-y-2 overflow-y-auto"},Mt={class:"text-secondary-foreground font-medium"},$t={class:"text-muted-foreground mt-1 text-sm"},Pt=N({__name:"mcp-server-detail",props:{id:{},isView:{type:Boolean},isJsonImport:{type:Boolean},isSystemMcp:{type:Boolean}},emits:["close"],setup(k,{emit:w}){const x=k,S=w,l=g(()=>x.id||T.query.id||null),{t:a}=j(),y=z(),T=V(),e=O({reconnecting:!1,formData:{mcpServerId:"",name:"",description:"",icon:"",type:"user",timeout:60,providerName:"",url:"",sortOrder:0,isDisabled:!1,creatorId:"",connectError:"",connectable:!1,tools:[],isShow:!1,isAssociated:!1,communicationType:""}}),{lockFn:v,isLock:B}=D(async()=>{try{let n;x.isSystemMcp?n=await W(l.value):n=await X(l.value),Object.assign(e.formData,n)}catch(n){console.error("获取供应商详情失败:",n)}}),{lockFn:C,isLock:M}=D(async()=>{try{const n=await Y(l.value);n.connectable?(y.success(n.message),v(),e.reconnecting=!0):y.error(n.message)}catch(n){console.error("重新链接失败:",n)}}),$=g(()=>e.formData.communicationType?e.formData.communicationType.includes("-")?e.formData.communicationType.replace("-"," ").toUpperCase():e.formData.communicationType?.toUpperCase():"");return q(async()=>l.value&&await v()),(n,u)=>{const I=R,U=A,h=H,f=P,F=G,L=Q;return r(),b(L,{title:t(a)("ai-mcp.backend.detailTitle"),description:t(a)("ai-mcp.backend.detailTitle"),ui:{content:"max-w-2xl overflow-y-auto h-fit"},onClose:u[1]||(u[1]=p=>S("close",t(e).reconnecting))},{default:c(()=>[t(B)?(r(),i("div",Z,[d(I,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):(r(),i("div",tt,[o("div",et,[o("div",ot,[d(U,{src:t(e).formData.icon,alt:t(e).formData.name,size:"3xl",ui:{root:"rounded-lg"}},null,8,["src","alt"]),o("div",null,[o("h3",st,[d(h,{text:t(e).formData.name,delay:0},{default:c(()=>[o("span",at,s(t(e).formData.name),1)]),_:1},8,["text"])]),d(f,{color:t(e).formData.type==="user"?"info":"primary"},{default:c(()=>[m(s(t(e).formData.type==="user"?t(a)("console-common.tab.custom"):t(a)("console-common.tab.system")),1)]),_:1},8,["color"])])]),!t(e).formData.connectable&&t(e).formData.type==="user"?(r(),b(F,{key:0,class:"h-fit",loading:t(M),icon:"tabler:reload",ui:{leadingIcon:"size-4"},variant:"soft",size:"md",color:"error",onClick:u[0]||(u[0]=p=>t(C)())},{default:c(()=>[m(s(t(a)("ai-mcp.backend.detail.reconnect")),1)]),_:1},8,["loading"])):_("",!0)]),o("div",nt,[o("p",rt,s(t(e).formData.description||t(a)("ai-mcp.frontend.detail.noDescription")),1)]),o("div",ct,[t(e).formData.type==="user"?(r(),i("div",it,[o("div",dt,s(t(a)("ai-mcp.frontend.detail.url")),1),d(h,{text:t(e).formData.url,ui:{content:"max-w-100 !whitespace-pre-wrap break-all leading-relaxed h-fit p-2"},"delay-duration":0},{content:c(()=>[o("div",mt,s(t(e).formData.url),1)]),default:c(()=>[o("div",lt,s(t(e).formData.url),1)]),_:1},8,["text"])])):_("",!0),o("div",null,[o("div",ut,s(t(a)("ai-mcp.frontend.detail.timeout")),1),o("div",ft,s(t(e).formData.timeout)+" s ",1)]),x.isSystemMcp?_("",!0):(r(),i("div",pt,[o("div",_t,s(t(a)("ai-mcp.frontend.detail.status")),1),o("div",xt,[d(f,{color:t(e).formData.isDisabled?"warning":"success"},{default:c(()=>[m(s(t(e).formData.isDisabled?t(a)("ai-mcp.frontend.detail.disabled"):t(a)("ai-mcp.frontend.detail.enabled")),1)]),_:1},8,["color"])])])),o("div",null,[o("div",yt,s(t(a)("ai-mcp.frontend.detail.sortOrder")),1),o("div",vt,s(t(e).formData.sortOrder),1)]),o("div",null,[o("div",ht,s(t(a)("ai-mcp.backend.detail.connectStatus")),1),o("div",gt,[d(f,{color:t(e).formData.connectable?"success":"error"},{default:c(()=>[m(s(t(e).formData.connectable?t(a)("ai-mcp.backend.detail.connectSuccess"):t(a)("ai-mcp.backend.detail.connectFailed")),1)]),_:1},8,["color"])])]),o("div",null,[o("div",Dt,s(t(a)("ai-mcp.backend.detail.communicationType")),1),o("div",bt,[d(f,{color:"neutral",variant:"soft"},{default:c(()=>[m(s(t($)),1)]),_:1})])]),o("div",null,[o("div",kt,s(t(a)("ai-mcp.backend.detail.connectError")),1),t(e).formData.connectError?(r(),i("div",wt,s(t(e).formData.connectError),1)):(r(),i("div",St,"-"))])]),t(e).formData.tools&&t(e).formData.tools.length>0?(r(),i("div",Tt,[o("h4",Bt,s(t(a)("ai-mcp.backend.detail.tools")),1),o("div",Ct,[(r(!0),i(J,null,K(t(e).formData.tools,(p,E)=>(r(),i("div",{key:E,class:"border-muted rounded-lg border p-4"},[o("div",Mt,s(p.name),1),o("div",$t,s(p.description),1)]))),128))])])):_("",!0)]))]),_:1},8,["title","description"])}}});export{Pt as default};
