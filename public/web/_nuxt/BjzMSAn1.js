const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./I617nE-R.js","./--UdezPG.js","./CpacWlXu.js","./CBooyAK7.js","./BYK_1AlN.js","./BJ_E6Ph7.js","./DSMB-qMT.js","./b-_TUx9i.js","./B22A-h4k.js","./Cfcu-t3n.js","./B128ot1i.js","./CoMGTw2w.js","./CP4Zo7YT.js","./XpsTG8vq.js","./CChenI34.js","./B93AZ-4h.js","./Brv-RyRx.js","./DBjGnECu.js","./Bcl4vaIv.js","./Bu7cOM_l.js","./BO1GPLSL.js","./CLTNKp0S.js","./8-c-A7PB.js","./kRIii9yh.js","./TH-3OOuG.js","./C6Y-ieo6.js","./DaNf1Wdt.js","./CKXZhss7.js","./Cpt2kRVT.js","./pUN2d83w.js","./Bub1HYiY.js","./DqVgEjI6.js","./wzR9Rzye.js","./ZZC6mEJB.js","./BgHJjJs-.js","./DN9ov8OT.js","./nBDBqKnC.js","./BYwSSEjb.js","./CfxLE1oh.js","./CbV7oF7N.js","./CqN3ElKI.js","./BaNg8fjw.js","./DlAUqK2U.js","./BDS0FVMi.js","./UqhBTNL6.js","./BQx-_Btj.js","./DNgvVYsj.js","./BUyfW8JT.js","./DaWZu8wl.js","./BIwjuh_U.js","./DXtH8ltM.js","./D-XbLhx8.js","./Di6e_Jmj.js","./CuEMRQ6m.js","./CbuHra-u.js","./9bDOsXij.js"])))=>i.map(i=>d[i]);
import{d as J,Q as K,s as x,w as G,aS as oe,j as R,o as c,k as D,r as se,l,_ as W,c as k,t as P,y as X,p as o,v as $,q as n,A as Q,F as Y,B as Z,x as le,R as A,U as C,aq as ne,b as ie,a1 as re,i as ce,n as N}from"#entry";import ee from"./--UdezPG.js";import{_ as de}from"./Bu7cOM_l.js";import{_ as ue}from"./BO1GPLSL.js";import{a as me}from"./CChenI34.js";import{_ as pe}from"./EHoVw6ZP.js";import{_ as ge}from"./DWuptxHM.js";import{_ as fe}from"./D-yR6Fj9.js";import{u as H,v as _e,w as he,x as ve,y as ye}from"./BDS0FVMi.js";import{u as be}from"./B93AZ-4h.js";import"./CLTNKp0S.js";import"./8-c-A7PB.js";import"./kRIii9yh.js";import"./TH-3OOuG.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Cpt2kRVT.js";import"./pUN2d83w.js";import"./B22A-h4k.js";import"./Bub1HYiY.js";import"./DN9ov8OT.js";import"./BstbYvQo.js";import"./Dn8X9Gvz.js";import"./DlAUqK2U.js";const we={key:0,class:"text-sm"},ke={key:1,class:"text-dimmed flex-none text-sm"},$e={class:"flex flex-col gap-2 p-2"},xe={key:0,class:"flex flex-col gap-1"},Te={key:1,class:"flex h-30 flex-col items-center justify-center gap-2"},Ve={class:"text-muted text-sm"},Ie=J({__name:"tag-select",props:{modelValue:{default:()=>[]},type:{default:"app"}},emits:["update:modelValue","change","close"],setup(q,{emit:z}){const M=A(()=>C(()=>import("./I617nE-R.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),T=z,U=q,p=oe(U,"modelValue",T),E=K(),g=x([]),i=x([]),t=x(""),r=x(!1),_=async()=>{const a=await me({type:U.type});g.value=a,L()},V=a=>{i.value.includes(a)?i.value=i.value.filter(u=>u.id!==a.id):i.value.push(a),p.value=i.value.map(u=>u.id),T("change",a)},d=async()=>{await E.create(M).open({type:U.type}).result,await _()},L=()=>{if(!g.value?.length){i.value=[];return}i.value=g.value.filter(a=>p.value?.includes(a.id))},B=()=>{p.value=[],i.value=[],T("change",[])};return G(()=>p.value,()=>{L()},{deep:!1}),G(r,a=>{a?_():T("close")}),(a,u)=>{const I=X,S=W,O=ee,j=de,F=ue;return c(),R(F,{open:o(r),"onUpdate:open":u[1]||(u[1]=f=>Q(r)?r.value=f:null),content:{align:"center",side:"bottom",sideOffset:8}},{content:D(()=>[n("div",$e,[l(O,{modelValue:o(t),"onUpdate:modelValue":u[0]||(u[0]=f=>Q(t)?t.value=f:null),placeholder:a.$t("common.search"),clearable:"",icon:"i-lucide-search",variant:"soft",color:"neutral",ui:{root:"w-full",base:"w-full",trailing:"pr-1"}},null,8,["modelValue","placeholder"]),n("div",null,[o(g).length>0?(c(),k("div",xe,[(c(!0),k(Y,null,Z(o(g),f=>(c(),R(S,{key:f.id,color:"neutral",variant:"ghost",ui:{base:"justify-between"},onClick:e=>V(f)},{default:D(()=>[le($(f.name)+" ",1),o(p).includes(f.id)?(c(),R(I,{key:0,name:"i-lucide-check",class:"size-4"})):P("",!0)]),_:2},1032,["onClick"]))),128))])):P("",!0),o(g).length===0?(c(),k("div",Te,[l(I,{name:"i-lucide-tags",class:"size-5"}),n("span",Ve,$(a.$t("common.tag.noTags")),1)])):P("",!0)]),l(j,{type:"dashed"}),n("div",null,[l(S,{label:a.$t("common.tag.manageTags"),color:"neutral",variant:"ghost",icon:"i-lucide-tags",ui:{base:"w-full"},onClick:d},null,8,["label"])])])]),default:D(()=>[se(a.$slots,"trigger",{},()=>[l(S,{color:"neutral",variant:"outline",ui:{base:"gap-2"}},{default:D(()=>[l(I,{name:"i-lucide-tag",class:"size-4"}),o(p).length>0?(c(),k("span",we,$(o(p).length)+$(a.$t("common.tag.tags")),1)):(c(),k("span",ke,$(a.$t("common.tag.allTags")),1)),o(p).length>0?(c(),R(S,{key:2,color:"neutral",variant:"soft",icon:"i-lucide-x",size:"xs",onClick:B})):P("",!0),l(I,{name:"i-lucide-chevron-down",class:"text-dimmed size-4 shrink-0"})]),_:1})])]),_:3},8,["open"])}}}),Se={class:"flex w-full flex-col items-center justify-center"},Ae={class:"bg-background sticky top-0 z-10 flex w-full flex-wrap justify-between gap-4 pb-2"},Ce={class:"flex items-center gap-4"},De={class:"grid grid-cols-1 gap-6 pt-2 pb-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Ue={class:"group-hover:text-primary text-foreground mb-3 flex items-center gap-3"},Re={class:"border-default flex size-10 flex-none items-center justify-center rounded-lg border border-dashed"},Ee={class:"truncate text-sm font-medium"},Le={class:"text-muted-foreground mb-6 pr-8 text-xs"},Pe={class:"line-clamp-2 overflow-hidden"},ze={class:"flex items-center gap-2"},ut=J({__name:"list",setup(q){const z=A(()=>C(()=>import("./Brv-RyRx.js"),__vite__mapDeps([16,2,3,17,18,1,19,20,21,22,23,24,9,25,7,26,27,28,29,8,30,14,31]),import.meta.url)),M=A(()=>C(()=>import("./wzR9Rzye.js"),__vite__mapDeps([32,33,2,34,35,36,37,1,38,39,4,5,6,7,8,9,10,11,12,13,40,41,42,43,44]),import.meta.url)),T=A(()=>C(()=>import("./BQx-_Btj.js"),__vite__mapDeps([45,2,37,34,40,1,41,42,38,46,4,5,6,7,8,9,10,11,12,13,43,47,48,49,31]),import.meta.url)),U=A(()=>C(()=>import("./DXtH8ltM.js"),__vite__mapDeps([50,2,1,3,51,11,6,7,8,9,52,43,42]),import.meta.url)),p=A(()=>C(()=>import("./CuEMRQ6m.js"),__vite__mapDeps([53,54,2,22,8,28,29,55,3,40,1,41,42,37,34,4,5,6,7,9,10,11,12,13,43]),import.meta.url)),E=ne(),{t:g}=ie(),i=K(),t=re({keyword:"",page:1,pageSize:15,tagIds:[],isPublic:void 0}),r=x(!1),_=x(!0),V=x([]),d=async()=>{if(!r.value){r.value=!0,t.page=1;try{const e=await H(t);V.value=e.items||[],_.value=e.totalPages>t.page}catch(e){console.error("获取数据失败:",e),_.value=!1}finally{r.value=!1}}},L=async()=>{if(!(r.value||!_.value)){r.value=!0,t.page!==void 0&&t.page++;try{const e=await H(t);e.items&&e.items.length>0?(V.value.push(...e.items),_.value=e.totalPages>(t.page||0)):_.value=!1}catch(e){t.page!==void 0&&t.page--,console.error("加载更多数据失败:",e)}finally{r.value=!1}}},B=async e=>{try{await be({title:g("console-common.delete"),description:g("ai-agent.backend.desc.delete"),color:"error"}),await _e(e.id);const s=t.page;t.page=1,t.pageSize=V.value.length,await d(),t.page=s,t.pageSize=15,E.success(g("common.message.deleteSuccess"))}catch(s){console.error("删除失败:",s)}},a=async(e=null)=>{await i.create(T).open({id:e}).result&&(t.page=1,t.pageSize=15,await d())},u=async()=>{const e=i.create(U);await e.open().result&&(t.page=1,t.pageSize=15,await d()),e.open()},I=e=>{a(e.id)},S=()=>{a(null)},O=async e=>{try{const s=await he(e.id,"yaml"),h=new Blob([s],{type:"text/yaml;charset=utf-8"}),v=URL.createObjectURL(h),m=document.createElement("a");m.href=v,m.download=`${e.name||"agent"}.yaml`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(v),E.success("DSL 文件导出成功！")}catch(s){console.error("导出 DSL 失败:",s)}},j=async()=>{await i.create(p).open().result&&(t.page=1,t.pageSize=15,await d())},F=async(e,s)=>{const h=e.tags?.map(w=>w.id)??[],v=s,m=v.filter(w=>!h.includes(w)),b=h.filter(w=>!v.includes(w));m.length===0&&b.length===0||(m.length>0&&await ve(e.id,m),b.length>0&&await ye(e.id,b),await d())},f=async()=>{i.create(M).open()};return ce(()=>d()),(e,s)=>{const h=ee,v=Ie,m=pe,b=W,w=X,te=ge,ae=fe;return c(),k("div",Se,[n("div",Ae,[n("div",Ce,[l(h,{modelValue:o(t).keyword,"onUpdate:modelValue":s[0]||(s[0]=y=>o(t).keyword=y),placeholder:e.$t("ai-agent.backend.search.placeholder"),class:"w-80",onChange:d},null,8,["modelValue","placeholder"]),l(v,{modelValue:o(t).tagIds,"onUpdate:modelValue":s[1]||(s[1]=y=>o(t).tagIds=y),onChange:d},null,8,["modelValue"]),l(m,{modelValue:o(t).isPublic,"onUpdate:modelValue":s[2]||(s[2]=y=>o(t).isPublic=y),items:[{label:e.$t("ai-agent.backend.search.allStatus"),value:void 0},{label:e.$t("ai-agent.backend.configuration.public"),value:!0},{label:e.$t("ai-agent.backend.configuration.private"),value:!1}],placeholder:e.$t("ai-agent.backend.search.filterByStatus"),"label-key":"label","value-key":"value",class:"w-48",onChange:d},null,8,["modelValue","items","placeholder"])]),n("div",null,[l(b,{color:"primary",variant:"ghost",icon:"i-lucide-package",label:e.$t("decorate.openDecorateSettings"),onClick:N(f,["stop"])},null,8,["label"])])]),l(ae,{class:"h-[calc(100vh-9rem)] min-h-0 w-full"},{default:D(()=>[l(te,{loading:o(r),"has-more":o(_),threshold:200,"loading-text":e.$t("common.loading"),"no-more-text":o(t).page!==1?e.$t("common.noMoreData"):" ",onLoadMore:L},{default:D(()=>[n("div",De,[n("div",{class:"group border-default relative cursor-pointer rounded-lg border border-dashed p-4 transition-all duration-200 hover:shadow-lg",onClick:S},[n("div",Ue,[n("div",Re,[l(w,{name:"i-lucide-plus",class:"h-6 w-6"})]),n("h3",Ee,$(e.$t("ai-agent.backend.create.title")),1)]),n("div",Le,[n("p",Pe,$(e.$t("ai-agent.backend.create.desc")),1)]),n("div",ze,[l(b,{color:"primary",variant:"ghost",class:"w-full",icon:"i-lucide-package",size:"sm",label:e.$t("ai-agent.backend.create.fromTemplate"),onClick:N(u,["stop"])},null,8,["label"]),l(b,{color:"neutral",variant:"ghost",class:"w-full",icon:"i-lucide-file-up",size:"sm",label:e.$t("ai-agent.backend.dslImport.import"),onClick:N(j,["stop"])},null,8,["label"])])]),(c(!0),k(Y,null,Z(o(V),y=>(c(),R(o(z),{key:y.id,agent:y,onDelete:B,onEdit:I,onExportDsl:O,onUpdateTags:F},null,8,["agent"]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})])}}});export{ut as default};
