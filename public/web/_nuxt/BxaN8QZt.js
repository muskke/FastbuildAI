import{d as G,b as H,s as $,f as K,c as y,o as u,q as r,l as o,x as b,v as s,k as i,y as Q,_ as W,F as X,B as Y,t as h,br as Z,j as U,p as n,aR as ee,A as oe,ap as ae}from"#entry";import{_ as te}from"./DGIb7fSK.js";import{_ as ne}from"./Cif_tCX1.js";import{_ as le}from"./ql0_WxJN.js";import{_ as ie}from"./DS-TE4M7.js";import re from"./BruVSCWF.js";import se from"./Dg6D3RQ3.js";import{_ as me}from"./ptVgWJmt.js";import{_ as ce}from"./CoK0jBu7.js";import{_ as de}from"./D-6Co9ha.js";import{_ as ue}from"./CXUt0j5Y.js";import{c as pe,a as C}from"./BUyfW8JT.js";import"./Btvd554H.js";import"./3UOIlTK8.js";import"./DuSMYVIA.js";import"./DduSJdeS.js";import"./VGKgjfSv.js";import"./BdImEx5p.js";import"./oFTPHjuc.js";import"./BcsO9TDZ.js";import"./DlAUqK2U.js";import"./BgHJjJs-.js";import"./CgMDXot0.js";import"./CR1AS2Ry.js";import"./DVnbt8cp.js";import"./D6yWePie.js";import"./CuOaO1Pb.js";import"./DHFmmngs.js";import"./C3zg6GHm.js";import"./CQBV3TNh.js";import"./BFVs1AfH.js";import"./kRIii9yh.js";import"./MN31c9CG.js";import"./C6Y-ieo6.js";import"./BPKB8n-W.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./Dkb19qXD.js";import"./BMSQkwth.js";import"./DaWZu8wl.js";import"./-Eb02sIQ.js";import"./Dk6FGhu1.js";import"./CCcv9mzY.js";import"./BFAo_s2U.js";import"./Cb04SOqd.js";const fe={class:"bg-muted rounded-lg p-3"},ge={class:"flex items-center justify-between"},_e={class:"text-foreground flex items-center gap-1 text-sm font-medium"},ve={class:"text-background text-xs"},ye={class:"space-y-3"},be={class:"flex flex-1 items-center gap-2"},ke={key:0,class:"bg-primary-50 border-default flex rounded-lg border border-dashed"},$e={class:"text-muted-foreground font-mono text-xs"},he={class:"block group-hover:hidden"},Ce={class:"hidden items-center group-hover:flex"},Ve={class:"flex items-center gap-2"},Te={class:"mt-6 flex justify-end gap-2"},ko=G({__name:"command",props:{modelValue:{}},emits:["update:modelValue"],setup(w,{emit:N}){const m=ee(w,"modelValue",N),{t:p}=H(),c=$(!1),f=$(!1),d=$(-1),B=pe({name:C().required(p("ai-agent.backend.configuration.commandNameEmpty")),content:C().required(p("ai-agent.backend.configuration.commandContentEmpty")),replyType:C().required(p("ai-agent.backend.configuration.commandReplyTypeEmpty"))}),V={avatar:"",name:"",content:"",replyType:"model",replyContent:""},a=K({...V}),R=async()=>{try{if(m.value.find((t,v)=>t.name===a.value.name&&v!==d.value)){ae().error(p("ai-agent.backend.configuration.formVariableNameExists"));return}f.value&&d.value>=0?m.value[d.value]=a.value:m.value.push(a.value),k()}catch(e){console.error("操作失败:",e)}},E=()=>{f.value=!1,d.value=-1,c.value=!0},F=e=>{f.value=!0,d.value=e;const t=m.value[e];t&&(a.value=JSON.parse(JSON.stringify(t)),c.value=!0)},q=()=>{a.value=V},k=()=>{c.value=!1,f.value=!1,d.value=-1,q()},z=e=>{m.value.splice(e,1)};return(e,t)=>{const v=Q,M=te,g=W,S=Z,j=ne,I=le,_=ie,D=re,O=se,T=me,A=ce,J=de,P=ue;return u(),y("div",null,[r("div",fe,[r("div",ge,[r("div",_e,[b(s(e.$t("ai-agent.backend.configuration.command"))+" ",1),o(M,{"delay-duration":0,ui:{content:"w-xs h-auto"}},{content:i(()=>[r("div",ve,s(e.$t("ai-agent.backend.configuration.commandDesc")),1)]),default:i(()=>[o(v,{name:"i-lucide-circle-help"})]),_:1})]),o(g,{size:"sm",color:"primary",variant:"ghost",class:"flex items-center",onClick:E},{default:i(()=>[o(v,{name:"i-lucide-plus"}),r("span",null,s(e.$t("console-common.add")),1)]),_:1})]),r("div",ye,[(u(!0),y(X,null,Y(n(m),(l,x)=>(u(),y("div",{key:l.name,class:"group bg-background mt-2 flex items-center gap-2 rounded-lg px-3 py-2"},[r("div",be,[l.avatar?(u(),y("div",ke,[o(S,{src:l?.avatar,alt:"avatar",class:"size-8 rounded-lg object-contain"},null,8,["src"])])):h("",!0),r("span",$e,s(l.name),1)]),r("div",he,[l.replyType?(u(),U(j,{key:0,color:"neutral",variant:"outline",size:"sm"},{default:i(()=>[b(s(l.replyType==="custom"?e.$t("ai-agent.backend.configuration.commandReplyTypeCustom"):e.$t("ai-agent.backend.configuration.commandReplyTypeModel")),1)]),_:2},1024)):h("",!0)]),r("div",Ce,[o(g,{size:"xs",color:"primary",variant:"ghost",icon:"i-lucide-edit",onClick:L=>F(x)},null,8,["onClick"]),o(g,{size:"xs",color:"error",variant:"ghost",icon:"i-lucide-trash",onClick:L=>z(x)},null,8,["onClick"])])]))),128))])]),o(P,{open:n(c),"onUpdate:open":t[6]||(t[6]=l=>oe(c)?c.value=l:null),title:n(f)?e.$t("ai-agent.backend.configuration.commandEditTitle"):e.$t("ai-agent.backend.configuration.commandAddTitle"),description:n(p)("ai-agent.backend.configuration.commandDesc"),ui:{content:"max-w-md"},onClose:k},{default:i(()=>[o(J,{state:n(a),schema:n(B),class:"space-y-4",onSubmit:R},{default:i(()=>[o(_,{label:e.$t("ai-agent.backend.configuration.commandUploadIcon"),name:"avatar"},{default:i(()=>[o(I,{modelValue:n(a).avatar,"onUpdate:modelValue":t[0]||(t[0]=l=>n(a).avatar=l),class:"h-16 w-16",text:" ",icon:"i-lucide-upload",accept:".jpg,.png,.jpeg,.gif,.webp",maxCount:1,single:!0,multiple:!1},null,8,["modelValue"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandName"),name:"name",required:""},{default:i(()=>[o(D,{modelValue:n(a).name,"onUpdate:modelValue":t[1]||(t[1]=l=>n(a).name=l),placeholder:e.$t("ai-agent.backend.configuration.commandNamePlaceholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandContent"),name:"content",required:""},{default:i(()=>[o(O,{modelValue:n(a).content,"onUpdate:modelValue":t[2]||(t[2]=l=>n(a).content=l),placeholder:e.$t("ai-agent.backend.configuration.commandContentPlaceholder"),ui:{root:"w-full"},rows:3},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandReplyType"),name:"type",required:""},{default:i(()=>[r("div",Ve,[o(T,{"model-value":n(a).replyType==="custom",indicator:"end",variant:"card","default-value":"",label:e.$t("ai-agent.backend.configuration.commandReplyTypeCustom"),"onUpdate:modelValue":t[3]||(t[3]=l=>n(a).replyType="custom")},null,8,["model-value","label"]),o(T,{"model-value":n(a).replyType==="model",indicator:"end",variant:"card","default-value":"",label:e.$t("ai-agent.backend.configuration.commandReplyTypeModel"),"onUpdate:modelValue":t[4]||(t[4]=l=>n(a).replyType="model")},null,8,["model-value","label"])])]),_:1},8,["label"]),n(a).replyType==="custom"?(u(),U(_,{key:0,label:e.$t("ai-agent.backend.configuration.commandReplyContent"),name:"replyContent",required:""},{default:i(()=>[o(A,{modelValue:n(a).replyContent,"onUpdate:modelValue":t[5]||(t[5]=l=>n(a).replyContent=l),outputFormat:"markdown","custom-class":"!h-auto min-h-50"},null,8,["modelValue"])]),_:1},8,["label"])):h("",!0),r("div",Te,[o(g,{color:"neutral",variant:"soft",size:"lg",onClick:k},{default:i(()=>[b(s(e.$t("console-common.cancel")),1)]),_:1}),o(g,{color:"primary",size:"lg",type:"submit"},{default:i(()=>[b(s(e.$t("console-common.save")),1)]),_:1})])]),_:1},8,["state","schema"])]),_:1},8,["open","title","description"])])}}});export{ko as default};
