import{d as G,b as H,s as $,f as K,c as y,o as u,q as r,l as o,x as b,v as s,k as i,y as Q,_ as W,F as X,B as Y,t as h,bs as Z,j as U,p as n,aS as ee,A as oe,aq as ae}from"#entry";import{_ as te}from"./BqoA6bN6.js";import{_ as ne}from"./CBooyAK7.js";import{_ as le}from"./CqN3ElKI.js";import{_ as ie}from"./BYwSSEjb.js";import re from"./--UdezPG.js";import se from"./CfxLE1oh.js";import{_ as me}from"./BwTGIg9g.js";import{_ as ce}from"./iqoKNu2e.js";import{_ as de}from"./DNgvVYsj.js";import{_ as ue}from"./BYK_1AlN.js";import{c as pe,a as C}from"./BUyfW8JT.js";import"./TH-3OOuG.js";import"./Bub1HYiY.js";import"./B22A-h4k.js";import"./lw_U4-W2.js";import"./XpsTG8vq.js";import"./BaNg8fjw.js";import"./DlAUqK2U.js";import"./BgHJjJs-.js";import"./BWWuJQeZ.js";import"./DN9ov8OT.js";import"./9bDOsXij.js";import"./pUN2d83w.js";import"./Cpt2kRVT.js";import"./8-c-A7PB.js";import"./nBDBqKnC.js";import"./B1Lg5z9T.js";import"./CLTNKp0S.js";import"./kRIii9yh.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./DyWX1Ime.js";import"./BMSQkwth.js";import"./DaWZu8wl.js";import"./B_gLqRAo.js";import"./BJ_E6Ph7.js";import"./DSMB-qMT.js";import"./B128ot1i.js";import"./CoMGTw2w.js";import"./CP4Zo7YT.js";const fe={class:"bg-muted rounded-lg p-3"},ge={class:"flex items-center justify-between"},_e={class:"text-foreground flex items-center gap-1 text-sm font-medium"},ve={class:"text-background text-xs"},ye={class:"space-y-3"},be={class:"flex flex-1 items-center gap-2"},ke={key:0,class:"bg-primary-50 border-default flex rounded-lg border border-dashed"},$e={class:"text-muted-foreground font-mono text-xs"},he={class:"block group-hover:hidden"},Ce={class:"hidden items-center group-hover:flex"},Ve={class:"flex items-center gap-2"},Te={class:"mt-6 flex justify-end gap-2"},bo=G({__name:"command",props:{modelValue:{}},emits:["update:modelValue"],setup(w,{emit:N}){const m=ee(w,"modelValue",N),{t:p}=H(),c=$(!1),f=$(!1),d=$(-1),B=pe({name:C().required(p("ai-agent.backend.configuration.commandNameEmpty")),content:C().required(p("ai-agent.backend.configuration.commandContentEmpty")),replyType:C().required(p("ai-agent.backend.configuration.commandReplyTypeEmpty"))}),V={avatar:"",name:"",content:"",replyType:"model",replyContent:""},a=K({...V}),q=async()=>{try{if(m.value.find((t,v)=>t.name===a.value.name&&v!==d.value)){ae().error(p("ai-agent.backend.configuration.formVariableNameExists"));return}f.value&&d.value>=0?m.value[d.value]=a.value:m.value.push(a.value),k()}catch(e){console.error("操作失败:",e)}},E=()=>{f.value=!1,d.value=-1,c.value=!0},F=e=>{f.value=!0,d.value=e;const t=m.value[e];t&&(a.value=JSON.parse(JSON.stringify(t)),c.value=!0)},R=()=>{a.value=V},k=()=>{c.value=!1,f.value=!1,d.value=-1,R()},S=e=>{m.value.splice(e,1)};return(e,t)=>{const v=Q,z=te,g=W,M=Z,j=ne,I=le,_=ie,D=re,O=se,T=me,A=ce,J=de,P=ue;return u(),y("div",null,[r("div",fe,[r("div",ge,[r("div",_e,[b(s(e.$t("ai-agent.backend.configuration.command"))+" ",1),o(z,{"delay-duration":0,ui:{content:"w-xs h-auto"}},{content:i(()=>[r("div",ve,s(e.$t("ai-agent.backend.configuration.commandDesc")),1)]),default:i(()=>[o(v,{name:"i-lucide-circle-help"})]),_:1})]),o(g,{size:"sm",color:"primary",variant:"ghost",class:"flex items-center",onClick:E},{default:i(()=>[o(v,{name:"i-lucide-plus"}),r("span",null,s(e.$t("console-common.add")),1)]),_:1})]),r("div",ye,[(u(!0),y(X,null,Y(n(m),(l,x)=>(u(),y("div",{key:l.name,class:"group bg-background mt-2 flex items-center gap-2 rounded-lg px-3 py-2"},[r("div",be,[l.avatar?(u(),y("div",ke,[o(M,{src:l?.avatar,alt:"avatar",class:"size-8 rounded-lg object-contain"},null,8,["src"])])):h("",!0),r("span",$e,s(l.name),1)]),r("div",he,[l.replyType?(u(),U(j,{key:0,color:"neutral",variant:"outline",size:"sm"},{default:i(()=>[b(s(l.replyType==="custom"?e.$t("ai-agent.backend.configuration.commandReplyTypeCustom"):e.$t("ai-agent.backend.configuration.commandReplyTypeModel")),1)]),_:2},1024)):h("",!0)]),r("div",Ce,[o(g,{size:"xs",color:"primary",variant:"ghost",icon:"i-lucide-edit",onClick:L=>F(x)},null,8,["onClick"]),o(g,{size:"xs",color:"error",variant:"ghost",icon:"i-lucide-trash",onClick:L=>S(x)},null,8,["onClick"])])]))),128))])]),o(P,{open:n(c),"onUpdate:open":t[6]||(t[6]=l=>oe(c)?c.value=l:null),title:n(f)?e.$t("ai-agent.backend.configuration.commandEditTitle"):e.$t("ai-agent.backend.configuration.commandAddTitle"),description:n(p)("ai-agent.backend.configuration.commandDesc"),ui:{content:"max-w-md"},onClose:k},{default:i(()=>[o(J,{state:n(a),schema:n(B),class:"space-y-4",onSubmit:q},{default:i(()=>[o(_,{label:e.$t("ai-agent.backend.configuration.commandUploadIcon"),name:"avatar"},{default:i(()=>[o(I,{modelValue:n(a).avatar,"onUpdate:modelValue":t[0]||(t[0]=l=>n(a).avatar=l),class:"h-16 w-16",text:" ",icon:"i-lucide-upload",accept:".jpg,.png,.jpeg,.gif,.webp",maxCount:1,single:!0,multiple:!1},null,8,["modelValue"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandName"),name:"name",required:""},{default:i(()=>[o(D,{modelValue:n(a).name,"onUpdate:modelValue":t[1]||(t[1]=l=>n(a).name=l),placeholder:e.$t("ai-agent.backend.configuration.commandNamePlaceholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandContent"),name:"content",required:""},{default:i(()=>[o(O,{modelValue:n(a).content,"onUpdate:modelValue":t[2]||(t[2]=l=>n(a).content=l),placeholder:e.$t("ai-agent.backend.configuration.commandContentPlaceholder"),ui:{root:"w-full"},rows:3},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandReplyType"),name:"type",required:""},{default:i(()=>[r("div",Ve,[o(T,{"model-value":n(a).replyType==="custom",indicator:"end",variant:"card","default-value":"",label:e.$t("ai-agent.backend.configuration.commandReplyTypeCustom"),"onUpdate:modelValue":t[3]||(t[3]=l=>n(a).replyType="custom")},null,8,["model-value","label"]),o(T,{"model-value":n(a).replyType==="model",indicator:"end",variant:"card","default-value":"",label:e.$t("ai-agent.backend.configuration.commandReplyTypeModel"),"onUpdate:modelValue":t[4]||(t[4]=l=>n(a).replyType="model")},null,8,["model-value","label"])])]),_:1},8,["label"]),n(a).replyType==="custom"?(u(),U(_,{key:0,label:e.$t("ai-agent.backend.configuration.commandReplyContent"),name:"replyContent",required:""},{default:i(()=>[o(A,{modelValue:n(a).replyContent,"onUpdate:modelValue":t[5]||(t[5]=l=>n(a).replyContent=l),outputFormat:"markdown","custom-class":"!h-auto min-h-50"},null,8,["modelValue"])]),_:1},8,["label"])):h("",!0),r("div",Te,[o(g,{color:"neutral",variant:"soft",size:"lg",onClick:k},{default:i(()=>[b(s(e.$t("console-common.cancel")),1)]),_:1}),o(g,{color:"primary",size:"lg",type:"submit"},{default:i(()=>[b(s(e.$t("console-common.save")),1)]),_:1})])]),_:1},8,["state","schema"])]),_:1},8,["open","title","description"])])}}});export{bo as default};
