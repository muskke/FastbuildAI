import{s as v}from"./BzLCLO6P.js";import{ar as w}from"#entry";function g(i,e){let n=null,r=0;const l=e?.interval||3e3,s=e?.maxAttempts||0,a=e?.stopCondition||!1,c=e?.maxWaitTime||0,m=Date.now(),u=()=>{n&&t(),n=v(async()=>{const o=typeof a=="function"?a():a,d=c>0&&Date.now()-m>c,p=s>0&&r>=s;if(o||p||d){t();return}r++;try{await i(t)}catch(x){throw t(),new Error(`轮询任务执行失败，错误信息：${x}`)}},l)},t=o=>{n&&(clearInterval(n),n=null,r=0,e?.onEnded?.()),o?.()},f=o=>{u(),o?.()};return w().beforeEach(()=>{t()}),{start:f,clear:t}}export{g as u};
