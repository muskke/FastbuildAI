import{f as v,H as b,g as d,V as I,W as g,X as w}from"#entry";import{u as _}from"./VGKgjfSv.js";const S=/^[^-]+.*-.*[^-]+$/,E=/^[^_]+.*_.*[^_]+$/,D=["arrowleft","arrowright","arrowup","arrowright","tab","escape","enter","backspace"];function j(h,p={}){const i=v([]),s=()=>{i.value.splice(0,i.value.length)},m=b(s,p.chainDelay??800),{macOS:y}=_(),u=I(),K=e=>{if(!e.key)return;const a=/^[a-z]{1}$/i.test(e.key),t=D.includes(e.key.toLowerCase());let c;if(i.value.push(e.key),i.value.length>=2){c=i.value.slice(-2).join("-");for(const n of f.value.filter(l=>l.chained))if(n.key===c){n.enabled&&(e.preventDefault(),n.handler(e)),s();return}}for(const n of f.value.filter(l=>!l.chained))if(e.key.toLowerCase()===n.key&&e.metaKey===n.metaKey&&e.ctrlKey===n.ctrlKey&&!((a||t)&&e.shiftKey!==n.shiftKey)){n.enabled&&(e.preventDefault(),n.handler(e)),s();return}m()},o=d(()=>{const e=u.value?.tagName,a=u.value?.contentEditable;return e==="INPUT"||e==="TEXTAREA"||a==="true"||a==="plaintext-only"?u.value?.name||!0:!1}),f=d(()=>Object.entries(g(h)).map(([e,a])=>{if(!a)return null;let t;e.includes("-")&&e!=="-"&&!e.includes("_")&&!e.match(S)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`),e.includes("_")&&e!=="_"&&!e.match(E)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`);const c=e.includes("-")&&e!=="-"&&!e.includes("_");if(c)t={key:e.toLowerCase(),metaKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1};else{const l=e.toLowerCase().split("_").map(r=>r);t={key:l.filter(r=>!["meta","command","ctrl","shift","alt","option"].includes(r)).join("_"),metaKey:l.includes("meta")||l.includes("command"),ctrlKey:l.includes("ctrl"),shiftKey:l.includes("shift"),altKey:l.includes("alt")||l.includes("option")}}if(t.chained=c,!y.value&&t.metaKey&&!t.ctrlKey&&(t.metaKey=!1,t.ctrlKey=!0),typeof a=="function"?t.handler=a:typeof a=="object"&&(t={...t,handler:a.handler}),!t.handler)return console.trace("[Shortcut] Invalid value"),null;let n=!0;return a.usingInput?typeof a.usingInput=="string"&&(n=o.value===a.usingInput):n=!o.value,t.enabled=n,t}).filter(Boolean));return w("keydown",K)}export{j as d};
