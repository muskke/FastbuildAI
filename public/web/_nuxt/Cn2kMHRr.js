const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CpLkiujk.js","./DiYXikHi.js","./IZm275qp.js","./jQG0lB_l.js","./CXUt0j5Y.js","./-Eb02sIQ.js","./Dk6FGhu1.js","./BPKB8n-W.js","./DuSMYVIA.js","./MN31c9CG.js","./CCcv9mzY.js","./BFAo_s2U.js","./Cb04SOqd.js","./VGKgjfSv.js","./B1iOVR-V.js","./ptVgWJmt.js","./CgMDXot0.js","./CR1AS2Ry.js","./DVnbt8cp.js","./D6yWePie.js","./CuOaO1Pb.js","./DHFmmngs.js","./C3zg6GHm.js","./BgHJjJs-.js","./B3Cet3zC.js","./CthPp3Zu.js","./D9nu2O3w.js","./BruVSCWF.js","./DS-TE4M7.js","./Dg6D3RQ3.js","./D-6Co9ha.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as T,b as F,Q as K,e as O,au as N,g as H,i as j,c as q,o as G,q as h,l as r,p as o,k as i,_ as Q,x as w,v as g,h as a,R as C,U as x}from"#entry";import{_ as J}from"./ptVgWJmt.js";import{_ as W}from"./CQBV3TNh.js";import{_ as X}from"./DiYXikHi.js";import Y from"./BruVSCWF.js";import{_ as Z}from"./DduSJdeS.js";import{_ as ee}from"./CB78hAg2.js";import{_ as oe}from"./Cif_tCX1.js";import{_ as te}from"./jQG0lB_l.js";import{_ as se}from"./CTfStZur.js";import{e as le,f as ae,g as re}from"./CthPp3Zu.js";import{u as ne}from"./BJ10eFuk.js";import{u as ie}from"./JqIoTTmi.js";import{u as ce}from"./BREwXy1w.js";import"./CgMDXot0.js";import"./CR1AS2Ry.js";import"./DVnbt8cp.js";import"./DuSMYVIA.js";import"./D6yWePie.js";import"./CuOaO1Pb.js";import"./DHFmmngs.js";import"./C3zg6GHm.js";import"./BgHJjJs-.js";import"./BFVs1AfH.js";import"./kRIii9yh.js";import"./Btvd554H.js";import"./MN31c9CG.js";import"./C6Y-ieo6.js";import"./BPKB8n-W.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./3UOIlTK8.js";import"./VGKgjfSv.js";import"./DlAUqK2U.js";const de={class:"role-list-container pb-5"},me={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},pe={class:"flex items-end gap-2 md:ml-auto"},ue={class:"mt-auto flex items-center justify-between gap-3 pt-4"},ge={class:"text-muted text-sm"},_e={class:"flex items-center gap-1.5"},Xe=T({__name:"list",setup(fe){const k=C(()=>x(()=>import("./CpLkiujk.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),U=C(()=>x(()=>import("./B1iOVR-V.js"),__vite__mapDeps([14,2,15,16,17,18,8,19,20,21,22,23,4,5,6,7,9,10,11,12,13,24,25]),import.meta.url)),$=C(()=>x(()=>import("./D9nu2O3w.js"),__vite__mapDeps([26,2,27,28,23,29,30,4,5,6,7,8,9,10,11,12,13,25,31,32]),import.meta.url)),A=J,c=Q,I=W,D=X,{t:l}=F(),{hasAccessByCodes:b}=ne(),v=K(),n=O("table"),_=N({name:"",description:""}),{paging:d,getLists:m}=ie({fetchFun:le,params:_}),p=H(()=>({select:l("console-common.select"),name:l("system-perms.role.name"),description:l("system-perms.role.describe"),status:l("console-common.status"),createdAt:l("console-common.createAt"),accountCount:l("system-perms.role.usersCount"),actions:l("console-common.operation")})),M=[{id:"select",header:({table:e})=>a(A,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>e.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:e})=>a(A,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>e.toggleSelected(!!t),ariaLabel:"Select row"})},{accessorKey:"name",header:()=>a("p",{class:""},`${p.value.name}`),cell:({row:e})=>a("div",{class:"flex items-center gap-3"},[a("div",void 0,[a("p",{class:""},`@${e.original.name}`)])])},{accessorKey:"description",header:()=>a("p",{class:""},`${p.value.description}`),cell:({row:e})=>{const t=e.getValue("description");return a("div",{class:"max-w-xs truncate"},t)}},{accessorKey:"users",header:()=>a("p",{class:""},`${p.value.accountCount}`),cell:({row:e})=>{const t=e.getValue("users");return a("div",{class:"max-w-xs truncate"},t.length)}},{accessorKey:"createdAt",header:({column:e})=>{const t=e.getIsSorted();return a(c,{color:"neutral",variant:"ghost",label:p.value.createdAt,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("createdAt");return a(D,{datetime:t,mode:"datetime"})}},{id:"actions",header:()=>a("p",{class:""},`${p.value.actions}`),size:40,enableSorting:!1,enableHiding:!1,cell:({row:e})=>a("div",{class:"flex items-center gap-1"},[b(["role:update"])?a(c,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:l("console-common.edit"),onClick:()=>{R(e.original.id||"")}}):null,b(["role:permissions"])?a(c,{icon:"i-lucide-shield-check",color:"primary",variant:"ghost",size:"xs",label:l("system-perms.role.permissions"),onClick:()=>{P(e.original.id||"")}}):null,b(["role:delete"])?a(c,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:l("console-common.delete"),onClick:()=>{S(e.original.id)}}):null].filter(Boolean))}],R=async e=>{await v.create($).open({id:e??null}).result&&m()},P=async e=>{await v.create(U).open({id:e}).result&&m()},z=(e,t)=>{v.create(k).open({users:e,roleName:t})},S=async e=>{try{await ce({title:l("system-perms.role.deleteTitle"),description:l("system-perms.role.deleteMsg"),color:"error"}),Array.isArray(e)?await ae({ids:e}):await re(e),m()}catch(t){console.error("删除失败:",t)}};return j(()=>m()),(e,t)=>{const f=Y,y=Z,V=ee,B=oe,E=te,L=se;return G(),q("div",de,[h("div",me,[r(f,{modelValue:o(_).name,"onUpdate:modelValue":t[0]||(t[0]=s=>o(_).name=s),placeholder:o(l)("system-perms.role.nameInput"),onChange:o(m)},null,8,["modelValue","placeholder","onChange"]),r(f,{modelValue:o(_).description,"onUpdate:modelValue":t[1]||(t[1]=s=>o(_).description=s),placeholder:o(l)("system-perms.role.descriptionInput"),ui:{root:"max-w-xs w-full"},onChange:o(m)},null,8,["modelValue","placeholder","onChange"]),h("div",pe,[r(V,{codes:["role:delete"]},{default:i(()=>[r(o(c),{color:"error",variant:"subtle",label:o(l)("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:!o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length,onClick:t[2]||(t[2]=s=>S(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.map(u=>u.original.id)))},{trailing:i(()=>[r(y,null,{default:i(()=>[w(g(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),r(o(I),{items:o(n)?.tableApi?.getAllColumns().filter(s=>s.getCanHide()).map(s=>({label:o(p)[s?.id]||s.columnDef.header,type:"checkbox",checked:s.getIsVisible(),onUpdateChecked(u){o(n)?.tableApi?.getColumn(s.id)?.toggleVisibility(!!u)},onSelect(u){u?.preventDefault()}})),content:{align:"end"}},{default:i(()=>[r(o(c),{label:o(l)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),r(V,{codes:["role:create"]},{default:i(()=>[r(o(c),{icon:"i-heroicons-plus",color:"primary",onClick:t[3]||(t[3]=()=>R(null))},{default:i(()=>[w(g(o(l)("system-perms.role.add")),1)]),_:1})]),_:1})])]),r(E,{loading:o(d).loading,data:o(d).items,columns:M,class:"h-[calc(100vh-13rem)] shrink-0",ref_key:"table",ref:n,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},{"users-cell":i(({row:s})=>[r(B,{class:"cursor-pointer",color:"primary",onClick:u=>z(s.original.users,s.original.name)},{default:i(()=>[w(g(s.original.users.length),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","data"]),h("div",ue,[h("div",ge,g(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" / "+g(o(n)?.tableApi?.getFilteredRowModel().rows.length||0)+" "+g(o(l)("console-common.selected"))+". ",1),h("div",_e,[r(L,{page:o(d).page,"onUpdate:page":t[4]||(t[4]=s=>o(d).page=s),size:o(d).pageSize,"onUpdate:size":t[5]||(t[5]=s=>o(d).pageSize=s),total:o(d).total,onChange:o(m)},null,8,["page","size","total","onChange"])])])])}}});export{Xe as default};
