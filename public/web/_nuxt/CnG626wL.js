import A from"./--UdezPG.js";import{_ as P}from"./BwTGIg9g.js";import{d as U,au as j,aq as I,b as L,a1 as F,s as u,i as q,c as h,o as f,q as o,l as d,p as r,k as g,y as N,v,F as E,B as G,j as H}from"#entry";import{_ as J}from"./CJG2iIES.js";import{_ as K}from"./DWuptxHM.js";import{_ as O}from"./D-yR6Fj9.js";import{i as y,v as Q,w as T}from"./DpSZ1r7x.js";import{_ as W}from"./oera9L7X.js";import{u as b}from"./B93AZ-4h.js";import{u as w}from"./DqVgEjI6.js";import"./BWWuJQeZ.js";import"./DN9ov8OT.js";import"./9bDOsXij.js";import"./B22A-h4k.js";import"./pUN2d83w.js";import"./Cpt2kRVT.js";import"./8-c-A7PB.js";import"./nBDBqKnC.js";import"./BgHJjJs-.js";import"./Dn8X9Gvz.js";import"./DlAUqK2U.js";import"./B1Lg5z9T.js";import"./CLTNKp0S.js";import"./kRIii9yh.js";import"./TH-3OOuG.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Bub1HYiY.js";import"./lw_U4-W2.js";import"./XpsTG8vq.js";import"./BqoA6bN6.js";import"./BI1JbAYD.js";import"./Dp_0VxUw.js";const X={class:"flex w-full flex-col items-center justify-center"},Y={class:"bg-background sticky top-0 z-10 flex w-full flex-wrap justify-between gap-4 pb-2"},Z={class:"grid grid-cols-1 gap-6 pt-2 pb-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},ee={class:"group-hover:text-primary text-foreground mb-3 flex items-center gap-3"},te={class:"border-default flex size-10 flex-none items-center justify-center rounded-lg border border-dashed"},ae={class:"truncate text-sm font-medium"},se={class:"text-muted-foreground mb-6 pr-8 text-xs"},oe={class:"line-clamp-2 overflow-hidden"},Ee=U({__name:"list",setup(re){const _=j(),c=I(),{t:s}=L(),t=F({keyword:"",showAll:!1,page:1,pageSize:15}),l=u(!1),i=u(!0),m=u([]),p=async()=>{if(!l.value){l.value=!0,t.page=1;try{const e=await y(t);m.value=e.items||[],i.value=e.totalPages>t.page}catch(e){console.error("获取数据失败:",e),i.value=!1}finally{l.value=!1}}},k=async()=>{if(!(l.value||!i.value)){l.value=!0,t.page&&t.page++;try{const e=await y(t);e.items&&e.items.length>0?(m.value.push(...e.items),t.page&&(t.page=t.page+1,i.value=e.totalPages>t.page)):i.value=!1}catch(e){t.page&&t.page--,console.error("加载更多数据失败:",e)}finally{l.value=!1}}},x=async e=>{try{await b({title:s("ai-datasets.backend.list.delete.title"),description:s("ai-datasets.backend.list.delete.desc"),color:"error"}),await Q(e.id);const a=t.page;t.page=1,t.pageSize=m.value.length,await p(),t.page=a,t.pageSize=15,c.success(s("common.message.deleteSuccess"))}catch(a){console.error("删除失败:",a)}},D=e=>{_.push(w("ai-datasets:update",{id:e.id}))},$=()=>{_.push(w("ai-datasets:create"))},S=async e=>{try{await b({title:s("ai-datasets.backend.dataset.retry.title"),description:s("ai-datasets.backend.dataset.retry.desc"),color:"warning"});const{success:a}=await T(e.id);a?c.success(s("ai-datasets.backend.dataset.retry.success")):c.error(s("ai-datasets.backend.dataset.retry.failed"))}catch{c.error(s("ai-datasets.backend.dataset.retry.failed"))}};return q(()=>p()),(e,a)=>{const C=A,V=P,B=N,M=J,R=K,z=O;return f(),h("div",X,[o("div",Y,[d(C,{modelValue:r(t).keyword,"onUpdate:modelValue":a[0]||(a[0]=n=>r(t).keyword=n),placeholder:e.$t("ai-datasets.backend.dataset.searchPlaceholder"),class:"w-80",onChange:p},null,8,["modelValue","placeholder"]),d(V,{modelValue:r(t).showAll,"onUpdate:modelValue":a[1]||(a[1]=n=>r(t).showAll=n),label:e.$t("ai-datasets.backend.dataset.allDatasets"),onChange:p},null,8,["modelValue","label"])]),d(z,{class:"h-[calc(100vh-9rem)] min-h-0 w-full"},{default:g(()=>[d(R,{loading:r(l),"has-more":r(i),threshold:200,"loading-text":e.$t("common.loading"),"no-more-text":r(t).page!==1?e.$t("common.noMoreData"):" ",onLoadMore:k},{default:g(()=>[o("div",Z,[d(M,{codes:["ai-datasets:create"]},{default:g(()=>[o("div",{class:"group border-default relative cursor-pointer rounded-lg border border-dashed p-4 transition-all duration-200 hover:shadow-lg",onClick:$},[o("div",ee,[o("div",te,[d(B,{name:"i-lucide-plus",class:"h-6 w-6"})]),o("h3",ae,v(e.$t("ai-datasets.backend.dataset.create.title")),1)]),o("div",se,[o("p",oe,v(e.$t("ai-datasets.backend.dataset.create.desc")),1)])])]),_:1}),(f(!0),h(E,null,G(r(m),n=>(f(),H(W,{key:n.id,dataset:n,onDelete:x,onSettings:D,onRetry:S},null,8,["dataset"]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})])}}});export{Ee as default};
