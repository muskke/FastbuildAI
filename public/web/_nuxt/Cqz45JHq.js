import{d as L,b as T,ap as j,au as q,aJ as y,g as k,i as z,j as x,o as u,k as i,c as E,p as e,q as l,l as n,y as I,v as f,x as h,_ as S}from"#entry";import G from"./BruVSCWF.js";import{_ as H}from"./DS-TE4M7.js";import{_ as J}from"./D-6Co9ha.js";import{_ as K}from"./CXUt0j5Y.js";import{c as O,d as P,e as R}from"./zsIs7mne.js";import{c as A,a as Q}from"./BUyfW8JT.js";import"./BgHJjJs-.js";import"./-Eb02sIQ.js";import"./Dk6FGhu1.js";import"./BPKB8n-W.js";import"./DuSMYVIA.js";import"./MN31c9CG.js";import"./CCcv9mzY.js";import"./BFAo_s2U.js";import"./Cb04SOqd.js";import"./VGKgjfSv.js";import"./DaWZu8wl.js";const W={key:0,class:"flex items-center justify-center py-12"},X={class:"flex flex-col items-center gap-3"},Y={class:"text-muted-foreground text-sm"},Z={class:"space-y-4"},ee={class:"flex justify-end gap-3 pt-6"},xe=L({__name:"edit",props:{id:{}},emits:["close"],setup(b,{emit:v}){const{t:o}=T(),_=j(),a=b,d=v,s=q({terminal:"web",name:"",configs:{backgroundColor:"#ffffff",backgroundDarkColor:"",backgroundImage:"",backgroundType:"solid",pageHeight:1080},content:[]}),$=A({name:Q().required(o("decorate.micropage.edit.pageNameRequired")).max(32,o("decorate.micropage.edit.pageNameMaxLength"))}),{lockFn:w,isLock:C}=y(async()=>{try{const c=await O(a.id);Object.keys(s).forEach(t=>{const r=t,m=c[r];m!==void 0&&(s[r]=m)})}catch(c){console.error("获取微页面详情失败:",c)}}),{lockFn:D,isLock:F}=y(async()=>{try{a.id?(await P(a.id,s),_.success(o("console-common.messages.success"))):(await R(s),_.success(o("console-common.messages.success"))),d("close",!0)}catch(c){console.error("提交失败:",c)}}),M=k(()=>a.id?o("decorate.micropage.edit.modalTitleEdit"):o("decorate.micropage.edit.modalTitleCreate")),N=k(()=>a.id?o("decorate.micropage.edit.modalDescriptionEdit"):o("decorate.micropage.edit.modalDescriptionCreate"));return z(async()=>a.id&&await w()),(c,t)=>{const r=I,m=G,U=H,g=S,B=J,V=K;return u(),x(V,{title:e(M),description:e(N),ui:{content:"max-w-md"},onClose:t[2]||(t[2]=p=>d("close",!1))},{default:i(()=>[e(C)?(u(),E("div",W,[l("div",X,[n(r,{name:"i-lucide-loader-2",class:"text-primary size-8 animate-spin"}),l("p",Y,f(e(o)("common.loading")),1)])])):(u(),x(B,{key:1,state:e(s),schema:e($),class:"space-y-6",onSubmit:e(D)},{default:i(()=>[l("div",Z,[n(U,{label:e(o)("decorate.micropage.edit.pageName"),name:"name",required:""},{default:i(()=>[n(m,{modelValue:e(s).name,"onUpdate:modelValue":t[0]||(t[0]=p=>e(s).name=p),placeholder:e(o)("decorate.micropage.edit.pageNamePlaceholder"),maxlength:"32","show-count":"",size:"lg",ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),l("div",ee,[n(g,{type:"button",variant:"outline",size:"lg",onClick:t[1]||(t[1]=p=>d("close",!1))},{default:i(()=>[h(f(e(o)("console-common.cancel")),1)]),_:1}),n(g,{type:"submit",loading:e(F),size:"lg",icon:"i-lucide-save"},{default:i(()=>[h(f(a.id?e(o)("console-common.update"):e(o)("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"]))]),_:1},8,["title","description"])}}});export{xe as default};
