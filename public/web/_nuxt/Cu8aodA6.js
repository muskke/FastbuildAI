import{u as K,_ as O}from"./BCxwPc3T.js";import{_ as X}from"./DfGLlJJ8.js";import{_ as Y}from"./BTCc_HRM.js";import{d as Z,aX as H,b as W,g as C,s as p,aY as ee,i as te,c as S,q as s,l as w,z as F,p as e,t as d,v as l,k as N,A as j,F as oe,B as se,j as I,C as ne,aZ as ae,o as i,_ as ie,n as re,x as $,ao as le,ap as ce,aK as me,am as ue}from"#entry";import{_ as pe}from"./BkAysFbf.js";import{d as de,e as fe,f as _e}from"./B1XcE43x.js";import{u as he}from"./C1DLXs69.js";import"./BruVSCWF.js";import"./DS-TE4M7.js";import"./BgHJjJs-.js";import"./CQBV3TNh.js";import"./BFVs1AfH.js";import"./DHFmmngs.js";import"./kRIii9yh.js";import"./Btvd554H.js";import"./MN31c9CG.js";import"./C6Y-ieo6.js";import"./BPKB8n-W.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./CuOaO1Pb.js";import"./D6yWePie.js";import"./DuSMYVIA.js";import"./3UOIlTK8.js";import"./DduSJdeS.js";import"./VGKgjfSv.js";import"./BNWstlnh.js";import"./i5AwkGQh.js";import"./BcsO9TDZ.js";import"./DlAUqK2U.js";import"./CcXhcZIb.js";import"./Dk6FGhu1.js";import"./CCcv9mzY.js";import"./BFAo_s2U.js";import"./eeyg4-1U.js";import"./BREwXy1w.js";import"./Cb04SOqd.js";import"./Cif_tCX1.js";import"./CvUJEDIF.js";import"./C7UmhjTd.js";import"./ybFaAORl.js";import"./DVnbt8cp.js";import"./D9F45f3T.js";import"./BygQEAzM.js";import"./DGIb7fSK.js";import"./BdImEx5p.js";import"./oFTPHjuc.js";import"./Dg6D3RQ3.js";import"./COxNVqQJ.js";const ge={class:"ai-chat dark:bg-muted/50 flex h-full min-h-0 items-center justify-center pl-0"},ve={class:"bg-background flex h-full min-h-0 flex-1 flex-col items-center justify-center rounded-lg"},ye={class:"flex h-full w-full max-w-[800px] flex-col items-center justify-center"},xe={class:"mb-8 text-center"},Ce={class:"mb-2 flex items-center justify-center text-2xl font-bold"},Se={class:"text-accent-foreground text-sm"},we={class:"w-full px-4"},Ie={key:0,class:"my-4 flex w-full flex-wrap justify-center gap-3"},be={class:"mr-1"},ke={class:"w-full p-2 text-center text-xs text-gray-400"},Me={class:"flex flex-col items-center justify-center gap-1"},Ve={class:"flex items-center justify-center gap-2"},Ae=["href"],Ue={key:0},Vt=Z({__name:"index",async setup(Ne){let f,z;const c=H(),{t:P}=W(),b=he(),Q=K(),m=C(()=>b.selectedModel?.id||""),k=p(""),n=p([]),_=p(!1),r=p(),h=p(),g=p([]),{data:v}=([f,z]=ee(()=>ae("chat-config",()=>fe())),f=await f,z(),f),T=C(()=>v.value?.suggestionsEnabled??!0),D=C(()=>v.value?.suggestions||[]),M=C(()=>v.value?.welcomeInfo||{});function E(t){g.value=t}function V(){try{const t=JSON.parse(localStorage.getItem("mcpIds")||"[]");return Array.isArray(t)?t:[]}catch{return[]}}function L(t){t.length?localStorage.setItem("mcpIds",JSON.stringify(t)):localStorage.removeItem("mcpIds")}const q=async()=>{try{const t=await de();if(!t)return;r.value=t,h.value=t.id,_.value=V().includes(h.value||"")}catch(t){console.error("Failed to fetch quick menu:",t)}};async function B(t){try{if(!m.value&&le().isLogin){ce().warning(P("ai-chat.frontend.selectModel"));return}const o=await _e({title:""});Q.setPendingConversation({id:o.id,modelId:m.value,title:t,files:g.value.length>0?g.value:void 0}),me("chats"),await ue({path:`/chat/${o.id}`})}catch(o){console.error("Failed to create conversation:",o)}}const R=()=>{if(!h.value)return;Array.isArray(n.value)||(n.value=[]);const t=V(),o=h.value,A=t.includes(o),y=n.value.includes(o);if(!A&&!y)t.push(o),y||n.value.push(o),L(t);else{const U=t.filter(u=>u!==o),x=n.value.filter(u=>u!==o);L(U),n.value=x}_.value=V().includes(o)};return te(()=>{q()}),(t,o)=>{const A=O,y=X,U=Y,x=ne,u=ie,G=pe;return i(),S("div",ge,[s("div",{class:F(["border-border/50 h-full flex-none border-r pl-0 sm:pl-2",{"border-none":!e(b).chatSidebarVisible}])},[w(A)],2),s("div",ve,[s("div",ye,[s("div",xe,[s("h1",Ce,l(e(M).title),1),s("p",Se,l(e(M).description),1)]),s("div",we,[w(G,{class:"[view-transition-name:chat-prompt]",modelValue:e(k),"onUpdate:modelValue":o[2]||(o[2]=a=>j(k)?k.value=a:null),"file-list":e(g),rows:2,needAuth:!0,attachmentSizeLimit:e(v)?.attachmentSizeLimit,onSubmit:B,"onUpdate:fileList":E},{"panel-left":N(()=>[w(y,{modelValue:e(m),"onUpdate:modelValue":o[0]||(o[0]=a=>j(m)?m.value=a:null),modelId:e(m)||"",supportedModelTypes:["llm"],"show-billingRule":!0,"open-local-storage":!0,placeholder:"选择AI模型开始对话",onChange:e(b).setSelectedModel},null,8,["modelValue","modelId","onChange"]),w(U,{modelValue:e(n),"onUpdate:modelValue":o[1]||(o[1]=a=>j(n)?n.value=a:null),mcpIds:e(n)||[],placeholder:"选择MCP..."},null,8,["modelValue","mcpIds"]),e(r)?(i(),I(u,{key:0,color:e(_)?"primary":"neutral",variant:"ghost",icon:e(r)?.icon?"":"tabler:tool",ui:{leadingIcon:"size-4"},class:F({"bg-primary/10":e(_)}),onClick:re(R,["stop"])},{default:N(()=>[e(r)?.icon?(i(),I(x,{key:0,src:e(r)?.icon,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),$(" "+l(e(r)?.alias||e(r)?.name),1)]),_:1},8,["color","icon","class"])):d("",!0)]),_:1},8,["modelValue","file-list","attachmentSizeLimit"])]),e(T)?(i(),S("div",Ie,[(i(!0),S(oe,null,se(e(D),(a,J)=>(i(),I(u,{key:J,variant:"outline",color:"neutral",size:"md",onClick:je=>B(a.text)},{default:N(()=>[s("span",be,l(a.icon),1),$(" "+l(a.text),1)]),_:2},1032,["onClick"]))),128))])):d("",!0)]),s("div",ke,[s("div",Me,[s("span",null,l(e(M).footer),1),s("div",Ve,[s("a",{href:e(c).siteConfig?.copyright.url,target:"_blank",rel:"noopener noreferrer",class:"hover:text-primary flex items-center justify-center gap-1 transition-colors"},[e(c).siteConfig?.copyright.iconUrl?(i(),I(x,{key:0,src:e(c).siteConfig?.copyright.iconUrl,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),s("span",null,l(e(c).siteConfig?.copyright.displayName),1)],8,Ae),e(c).siteConfig?.copyright.displayName||e(c).siteConfig?.copyright.iconUrl?(i(),S("span",Ue,"|")):d("",!0),o[3]||(o[3]=s("span",{class:"space-x-1"},[s("span",null,"Powered by"),s("a",{class:"text-primary font-bold",href:"https://www.buildingai.cc",target:"_blank"}," BuildingAI ")],-1))])])])])])}}});export{Vt as default};
