import{d as B,b as C,s as D,aJ as f,i as R,j as A,o as y,k as r,c as N,t as S,l as a,p as e,y as j,q,_ as z,x as k,v as $,ap as p}from"#entry";import L from"./BruVSCWF.js";import{_ as M}from"./DS-TE4M7.js";import T from"./Dg6D3RQ3.js";import{_ as E}from"./D-6Co9ha.js";import{_ as G}from"./CXUt0j5Y.js";import{a as J,c as H,d as K}from"./CthPp3Zu.js";import{c as O,a as P}from"./BUyfW8JT.js";import"./BgHJjJs-.js";import"./-Eb02sIQ.js";import"./Dk6FGhu1.js";import"./BPKB8n-W.js";import"./DuSMYVIA.js";import"./MN31c9CG.js";import"./CCcv9mzY.js";import"./BFAo_s2U.js";import"./Cb04SOqd.js";import"./VGKgjfSv.js";import"./DaWZu8wl.js";const Q={key:0,class:"flex items-center justify-center py-10"},W={class:"mt-10 flex justify-end gap-2"},ye=B({__name:"edit",props:{id:{}},emits:["close"],setup(b,{emit:v}){const i=v,m=b,{t:o}=C(),t=D({id:m.id,name:"",description:""}),V=O({name:P().required(o("system-perms.role.nameInput"))}),{lockFn:g,isLock:x}=f(async()=>{try{const{createdAt:n,updatedAt:s,permissions:d,...c}=await J(m.id);t.value=c}catch(n){console.error("获取详情失败:",n),p().error(o("system-perms.role.getRoleFailed"))}}),{lockFn:U,isLock:w}=f(async()=>{try{m.id?await H({...t.value,id:t.value.id}):await K(t.value),p().success(o("system-perms.role.success")),i("close",!0)}catch(n){console.error("提交失败:",n),p().error(o("system-perms.role.error"))}});return R(()=>m.id&&g()),(n,s)=>{const d=j,c=L,u=M,F=T,_=z,I=E,h=G;return y(),A(h,{title:e(o)("system-perms.role.roleInfo"),description:e(o)("system-perms.role.roleInfoDesc"),ui:{content:"max-w-md"},onClose:s[3]||(s[3]=l=>i("close",!1))},{default:r(()=>[e(x)?(y(),N("div",Q,[a(d,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):S("",!0),a(I,{state:e(t),schema:e(V),class:"space-y-4",onSubmit:e(U)},{default:r(()=>[a(u,{label:e(o)("system-perms.role.name"),name:"name",required:""},{default:r(()=>[a(c,{modelValue:e(t).name,"onUpdate:modelValue":s[0]||(s[0]=l=>e(t).name=l),placeholder:e(o)("system-perms.role.nameInput"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:e(o)("system-perms.role.describe"),name:"description"},{default:r(()=>[a(F,{modelValue:e(t).description,"onUpdate:modelValue":s[1]||(s[1]=l=>e(t).description=l),ui:{root:"w-full"},placeholder:e(o)("system-perms.role.descriptionInput")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),q("div",W,[a(_,{color:"neutral",variant:"soft",size:"lg",onClick:s[2]||(s[2]=l=>i("close",!1))},{default:r(()=>[k($(e(o)("console-common.cancel")),1)]),_:1}),a(_,{color:"primary",size:"lg",type:"submit",loading:e(w)},{default:r(()=>[k($(e(o)("console-common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"])]),_:1},8,["title","description"])}}});export{ye as default};
