import{_ as ee}from"./Cif_tCX1.js";import{d as te,b as oe,s as B,e as le,f as D,g as z,w as ae,i as se,j as g,o as a,k as u,l as m,_ as ne,m as ie,n as I,p as t,q as s,t as f,c as p,v as d,x as R,y as re,z as b,A as E,F as L,B as j,C as de,T as ce,D as ue,E as me,G as fe,H as pe}from"#entry";import ve from"./BruVSCWF.js";import{_ as _e}from"./CvUJEDIF.js";import{_ as ge}from"./C7UmhjTd.js";import{_ as he}from"./i5AwkGQh.js";import{a as ye,b as xe}from"./B1XcE43x.js";const be={class:"flex min-w-0 flex-1 items-center gap-1"},we={class:"inline-block w-12 truncate text-left sm:block sm:w-full"},ke={key:1,class:"flex flex-none items-center gap-1"},Be={class:"flex flex-none items-center gap-2"},Se={class:"bg-background w-fit min-w-80 overflow-hidden rounded-lg shadow-lg"},Ce={class:"p-2"},Ve={key:0,class:"text-muted-foreground col-span-full py-10 text-center"},Me={key:1,class:"text-muted-foreground col-span-full py-10 text-center"},Ue=["onClick"],ze={class:"flex flex-row items-center gap-2"},Re={class:"text-secondary-foreground text-sm font-semibold"},$e={class:"overflow-hidden"},Te=["data-model-id","onClick"],Pe={class:"w-full overflow-hidden"},Ae={class:"flex items-start justify-between gap-2"},De={key:0},Ie={key:0,class:"text-muted-foreground mt-0.5 line-clamp-1 text-xs"},He=te({__name:"model-select",props:{modelValue:{},disabled:{type:Boolean},showDescription:{type:Boolean,default:!0},defaultSelected:{type:Boolean,default:!0},console:{type:Boolean,default:!1},supportedModelTypes:{},buttonUi:{},showBillingRule:{type:Boolean,default:!1},openLocalStorage:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(F,{emit:N}){const i=F,$=N,{t:v}=oe(),w=B(!1),h=B(!1),k=B(""),y=B([]),l=B(null),T=le("scrollAreaRef"),x=D({}),S=D(!1),C=z(()=>y.value.flatMap(e=>e.models??[])),V=z(()=>{const e=k.value.trim().toLowerCase();return e?y.value.map(o=>({...o,models:o.models?.filter(c=>[c.name,c.model,o.name,o.provider].some(_=>_.toLowerCase().includes(e)))})).filter(o=>o.models?.length):y.value});function M(e){l.value=e,i.openLocalStorage&&localStorage.setItem("modelId",e?.id||""),$("update:modelValue",e?.id||""),$("change",e),h.value=!1,k.value="",U(e)}function q(e){x.value[e]=!x.value[e]}function P(e){return x.value[e]??!1}function U(e){if(!e)return;const o=y.value.find(c=>c.models?.some(_=>_.id===e.id));o&&(x.value[o.id]=!0)}async function G(){if(!w.value){w.value=!0;try{y.value=await ye({supportedModelTypes:i.supportedModelTypes}),y.value.forEach(o=>{o.id in x.value||(x.value[o.id]=!1)});const e=o=>C.value.find(c=>c.id===o);if(!i.defaultSelected){l.value=e(i.modelValue)??null,U(l.value);return}l.value=(i.openLocalStorage?e(localStorage.getItem("modelId")||""):null)??e(i.modelValue)??e((await xe().catch(()=>null))?.id)??C.value.find(o=>o.isDefault)??C.value[0]??null,l.value&&(M(l.value),U(l.value))}catch(e){console.error("Failed to load models",e)}finally{w.value=!1}}}const O=z(()=>C.value.find(e=>e.id===i.modelValue)),H=async()=>{if(!l.value||!h.value)return;await fe();const e=document.querySelector(`[data-model-id="${l.value.id}"]`);e&&T.value&&e.scrollIntoView({behavior:"instant",block:"center"})};ae(h,e=>{e&&H()});const J=pe(()=>{S.value=!1},200),K=()=>{S.value=!0,J()};return se(G),(e,o)=>{const c=ee,_=re,Q=ne,W=ve,X=de,Y=_e,A=ge,Z=he;return a(),g(A,{open:t(h),"onUpdate:open":o[3]||(o[3]=n=>E(h)?h.value=n:null),disabled:i.disabled},{content:u(()=>[s("div",Se,[s("div",Ce,[m(W,{modelValue:t(k),"onUpdate:modelValue":o[2]||(o[2]=n=>E(k)?k.value=n:null),placeholder:t(v)("common.placeholder.searchModel"),size:"lg",variant:"soft",ui:{root:"w-full"}},{leading:u(()=>[m(_,{name:"i-lucide-search"})]),_:1},8,["modelValue","placeholder"])]),s("div",{class:b(["flex h-[calc((100vh-15rem)/3)] flex-col gap-3 px-2 pt-1 pb-2",{"md:grid-cols-2":t(V).length>1}])},[m(Z,{ref_key:"scrollAreaRef",ref:T,class:"h-full",type:"hover",shadow:!1,onScroll:K},{default:u(()=>[t(w)?(a(),p("div",Ve,d(t(v)("common.loading"))+"... ",1)):t(V).length?f("",!0):(a(),p("div",Me,d(t(v)("common.empty")),1)),(a(!0),p(L,null,j(t(V),n=>(a(),p("section",{key:n.id,class:"mb-2 space-y-2"},[s("div",{class:"hover:bg-muted/50 bg-background sticky top-0 z-10 flex cursor-pointer flex-row items-center justify-between rounded-md py-1 pr-2 backdrop-blur-sm transition-colors",onClick:r=>q(n.id)},[s("div",ze,[m(_,{name:P(n.id)?"i-lucide-chevron-down":"i-lucide-chevron-right",class:"text-muted-foreground transition-transform",size:"sm"},null,8,["name"]),m(X,{src:n.iconUrl,alt:n.name,ui:{fallback:"text-inverted"},class:b(n.iconUrl?"":"bg-primary"),size:"2xs"},null,8,["src","alt","class"]),s("h3",Re,d(n.name),1)]),m(c,{variant:"soft",color:"neutral",size:"sm"},{default:u(()=>[R(d(n.models?.length)+d(t(v)("common.unit.general.item"))+d(t(v)("common.ai.model")),1)]),_:2},1024)],8,Ue),m(ce,{"enter-active-class":"transition-all duration-200 ease-out","leave-active-class":"transition-all duration-200 ease-in","enter-from-class":"opacity-0 max-h-0","enter-to-class":"opacity-100 max-h-[2000px]","leave-from-class":"opacity-100 max-h-[2000px]","leave-to-class":"opacity-0 max-h-0"},{default:u(()=>[ue(s("ul",$e,[(a(!0),p(L,null,j(n.models,r=>(a(),g(A,{key:r.id,mode:t(S)?void 0:"hover",disabled:t(S),content:{align:"center",side:"left",sideOffset:15}},{content:u(()=>[m(Y,{model:r,provider:n,"show-billing-rule":i.showBillingRule},null,8,["model","provider","show-billing-rule"])]),default:u(()=>[s("li",{"data-model-id":r.id,class:b(["group flex cursor-pointer items-center justify-between gap-2 rounded-md px-2 py-1.5 ring-1 ring-transparent transition-colors",[t(l)?.id===r.id?"bg-primary/10 dark:bg-primary/20 hover:bg-primary/15 dark:hover:bg-primary/25":"hover:bg-muted"]]),onClick:Ee=>M(r)},[s("div",Pe,[s("div",Ae,[s("p",{class:b(["max-w-54 text-sm font-medium break-all whitespace-normal",t(l)?.id===r.id?"text-primary":"text-secondary-foreground"])},d(r.name),3),i.showBillingRule?(a(),p("div",De,[r.billingRule.power===0?(a(),g(c,{key:0,variant:"soft",color:"neutral",size:"sm"},{default:u(()=>[R(d(t(v)("common.free")),1)]),_:1})):(a(),p("span",{key:1,class:b(["text-inverted flex w-fit items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-medium",t(l)?.id===r.id?"bg-primary dark:bg-primary-800":"bg-primary/10 text-primary"])},[s("span",null,d(r.billingRule.power)+d(t(v)("common.unit.points")),1),o[4]||(o[4]=s("span",null,"/",-1)),s("span",null,d(r.billingRule.tokens)+"Tokens",1)],2))])):f("",!0)]),i.showDescription&&r.description?(a(),p("p",Ie,d(r.description),1)):f("",!0)])],10,Te)]),_:2},1032,["mode","disabled"]))),128))],512),[[me,P(n.id)]])]),_:2},1024)]))),128))]),_:1},512)],2)])]),default:u(()=>[m(Q,ie({color:"neutral",variant:"soft",class:"flex items-center justify-between",loading:t(w),disabled:i.disabled},i.buttonUi,{onClick:o[1]||(o[1]=I(()=>{},["stop"]))}),{default:u(()=>[s("div",be,[s("span",we,d(t(l)?.name||t(O)?.name||t(v)("common.placeholder.modelSelect")),1),t(l)?.modelConfig?.mode?(a(),g(c,{key:0,variant:"outline",color:"neutral",size:"sm"},{default:u(()=>[R(d(String(t(l).modelConfig.mode).toUpperCase()),1)]),_:1})):f("",!0),t(l)&&(t(l).features?.includes("vision")||t(l).features?.includes("video")||t(l).features?.includes("audio"))?(a(),p("div",ke,[t(l)?.features?.includes("vision")?(a(),g(c,{key:0,icon:"i-lucide-eye",size:"sm",variant:"outline",color:"neutral"})):f("",!0),t(l)?.features?.includes("video")?(a(),g(c,{key:1,icon:"i-lucide-video",size:"sm",variant:"outline",color:"neutral"})):f("",!0),t(l)?.features?.includes("audio")?(a(),g(c,{key:2,icon:"i-lucide-audio-lines",size:"sm",variant:"outline",color:"neutral"})):f("",!0)])):f("",!0)]),s("div",Be,[t(l)?.name&&i.console?(a(),g(_,{key:0,name:"i-lucide-x",onClick:o[0]||(o[0]=I(n=>M(null),["stop"]))})):f("",!0),m(_,{name:"i-lucide-chevron-down",class:b({"rotate-180":t(h)})},null,8,["class"])])]),_:1},16,["loading","disabled"])]),_:1},8,["open","disabled"])}}});export{He as _};
