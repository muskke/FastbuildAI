import{d as N,b as z,aq as j,a1 as G,f as V,g as q,aK as v,i as A,c as S,o as u,j as D,p as e,q as a,v as l,l as o,k as r,C as M,_ as T,x as f,A as K}from"#entry";import{_ as O}from"./BYwSSEjb.js";import R from"./--UdezPG.js";import{_ as H}from"./DNgvVYsj.js";import{l as J,m as Q}from"./P4eVxJUJ.js";import{c as W,a as X}from"./BUyfW8JT.js";import"./BgHJjJs-.js";import"./DaWZu8wl.js";const Y={class:"extension-profiles-container pb-8"},Z={key:0,class:"space-y-4"},ee={class:"text-lg font-semibold"},te={class:"bg-muted space-y-4 rounded-lg p-4"},se={class:"text-sm font-medium"},oe={class:"text-muted-foreground text-sm"},ae={key:0,class:"flex flex-1 items-center justify-between gap-4"},le={class:"font-mono text-sm"},re={key:1,class:"flex flex-1 flex-col items-start gap-4"},ne={class:"flex gap-3"},ie={class:"space-y-4"},ce={class:"text-lg font-semibold"},fe={class:"space-y-1"},me={href:"https://www.buildingai.cc",target:"_blank",class:"text-primary hover:underline"},de={class:"flex gap-3 pt-4"},ke=N({__name:"index",setup(pe){const{t}=z(),g=j(),s=G({platformSecret:"",platformInfo:{}}),_=V(!1),i=V(""),F=W({platformSecret:X()}),b={root:"flex items-center gap-4",label:"min-w-20 flex-shrink-0"},C=q(()=>s.platformInfo&&Object.keys(s.platformInfo).length>0),{isLock:m,lockFn:k}=v(async()=>{try{const n=await J();s.platformInfo=n.platformInfo||{},s.platformSecret=n.platformSecret||"",_.value=!1,i.value=""}catch(n){console.error("Get platform info failed:",n)}}),y=async n=>{await Q({platformSecret:n}),g.success(t("extensions.profiles.setSecretSuccess")),await k()},{isLock:w,lockFn:U}=v(async()=>{try{await y(s.platformSecret)}catch(n){console.error("Failed to set platform secret:",n)}}),$=()=>{i.value="",_.value=!0},E=()=>{_.value=!1,i.value=""},{isLock:h,lockFn:P}=v(async()=>{try{await y(i.value)}catch(n){console.error("Failed to save secret:",n),g.error(t("extensions.profiles.setSecretError"))}});return A(()=>k()),(n,c)=>{const B=M,d=O,p=T,I=R,L=H;return u(),S("div",Y,[e(C)?(u(),S("div",Z,[a("h3",ee,l(e(t)("extensions.profiles.platformInfo")),1),a("div",te,[o(d,{label:e(t)("extensions.profiles.platformIcon"),ui:b},{default:r(()=>[o(B,{src:e(s).platformInfo?.websiteIcon,class:"size-10"},null,8,["src"])]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.platformName"),ui:b},{default:r(()=>[a("div",se,l(e(s).platformInfo?.websiteName),1)]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.appCount"),ui:b},{default:r(()=>[a("div",oe,l(e(s).platformInfo?.appCount),1)]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.platformSecret"),ui:{root:"flex items-baseline gap-4",label:"min-w-20 flex-shrink-0"}},{default:r(()=>[e(_)?(u(),S("div",re,[o(I,{modelValue:e(i),"onUpdate:modelValue":c[0]||(c[0]=x=>K(i)?i.value=x:null),placeholder:e(t)("extensions.profiles.platformSecretPlaceholder"),class:"w-90 flex-1"},null,8,["modelValue","placeholder"]),a("div",ne,[o(p,{color:"primary",loading:e(h),disabled:e(m),onClick:e(P)},{default:r(()=>[f(l(e(t)("extensions.profiles.saveSecret")),1)]),_:1},8,["loading","disabled","onClick"]),o(p,{variant:"outline",disabled:e(h)||e(m),onClick:E},{default:r(()=>[f(l(e(t)("extensions.profiles.cancelEdit")),1)]),_:1},8,["disabled"])])])):(u(),S("div",ae,[a("div",le,l(e(s).platformSecret||e(t)("extensions.profiles.emptySecret")),1),o(p,{variant:"outline",disabled:e(h)||e(m),onClick:$},{default:r(()=>[f(l(e(s).platformSecret?e(t)("extensions.profiles.editSecret"):e(t)("extensions.profiles.setSecret")),1)]),_:1},8,["disabled"])]))]),_:1},8,["label"])])])):(u(),D(L,{key:1,schema:e(F),state:e(s),class:"space-y-6",onSubmit:e(U)},{default:r(()=>[a("div",ie,[a("h3",ce,l(e(t)("extensions.profiles.platformSecret")),1),o(d,{label:e(t)("extensions.profiles.platformSecret"),name:"platformSecret",error:e(s).platformSecret&&!e(s).platformInfo?e(t)("extensions.profiles.secretError"):!1},{help:r(()=>[a("div",fe,[a("div",null,[f(l(e(t)("extensions.profiles.help"))+" ",1),a("a",me,l(e(t)("extensions.profiles.howToGetSecret")),1)])])]),default:r(()=>[o(I,{modelValue:e(s).platformSecret,"onUpdate:modelValue":c[1]||(c[1]=x=>e(s).platformSecret=x),placeholder:e(t)("extensions.profiles.platformSecretPlaceholder"),size:"lg",class:"w-sm"},null,8,["modelValue","placeholder"])]),_:1},8,["label","error"])]),a("div",de,[o(p,{color:"primary",size:"lg",type:"submit",loading:e(w),disabled:e(m)},{default:r(()=>[f(l(e(t)("console-common.save")),1)]),_:1},8,["loading","disabled"]),o(p,{variant:"outline",size:"lg",disabled:e(w)||e(m),onClick:c[2]||(c[2]=x=>e(s).platformSecret="")},{default:r(()=>[f(l(e(t)("console-common.reset")),1)]),_:1},8,["disabled"])])]),_:1},8,["schema","state","onSubmit"]))])}}});export{ke as default};
