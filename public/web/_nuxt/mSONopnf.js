import{u as O,_ as K}from"./B6ZzIxp0.js";import{_ as Y}from"./CPdnHwcb.js";import{_ as Z}from"./BVHcrJNM.js";import{d as H,aY as W,b as X,g as C,s as p,aZ as ee,i as te,c as S,q as s,l as w,z as F,p as e,t as d,v as l,k as N,A as j,F as oe,B as se,j as I,C as ne,a_ as ae,o as i,_ as ie,n as re,x as $,ap as le,aq as ce,aL as ue,an as me}from"#entry";import{_ as pe}from"./CdEI2ZYD.js";import{d as de,e as fe,f as _e}from"./B1XcE43x.js";import{u as he}from"./C1DLXs69.js";import"./--UdezPG.js";import"./BYwSSEjb.js";import"./BgHJjJs-.js";import"./B1Lg5z9T.js";import"./CLTNKp0S.js";import"./8-c-A7PB.js";import"./kRIii9yh.js";import"./TH-3OOuG.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Cpt2kRVT.js";import"./pUN2d83w.js";import"./B22A-h4k.js";import"./Bub1HYiY.js";import"./lw_U4-W2.js";import"./XpsTG8vq.js";import"./BsoAYZfI.js";import"./D-yR6Fj9.js";import"./Dn8X9Gvz.js";import"./DlAUqK2U.js";import"./D_xVtNgx.js";import"./DSMB-qMT.js";import"./B128ot1i.js";import"./CoMGTw2w.js";import"./eeyg4-1U.js";import"./B93AZ-4h.js";import"./CP4Zo7YT.js";import"./CBooyAK7.js";import"./PM3E-asR.js";import"./BO1GPLSL.js";import"./CbuHra-u.js";import"./9bDOsXij.js";import"./D9F45f3T.js";import"./B9WZOnAv.js";import"./BqoA6bN6.js";import"./BaNg8fjw.js";import"./CfxLE1oh.js";import"./Bu7cOM_l.js";const ge={class:"ai-chat dark:bg-muted/50 flex h-full min-h-0 items-center justify-center pl-0"},ve={class:"bg-background flex h-full min-h-0 flex-1 flex-col items-center justify-center rounded-lg"},ye={class:"flex h-full w-full max-w-[800px] flex-col items-center justify-center"},xe={class:"mb-8 text-center"},Ce={class:"mb-2 flex items-center justify-center text-2xl font-bold"},Se={class:"text-accent-foreground text-sm"},we={class:"w-full px-4"},Ie={key:0,class:"my-4 flex w-full flex-wrap justify-center gap-3"},be={class:"mr-1"},ke={class:"w-full p-2 text-center text-xs text-gray-400"},Me={class:"flex flex-col items-center justify-center gap-1"},Ve={class:"flex items-center justify-center gap-2"},Ae=["href"],Ue={key:0},Mt=H({__name:"index",async setup(Ne){let f,z;const c=W(),{t:P}=X(),b=he(),Q=O(),u=C(()=>b.selectedModel?.id||""),k=p(""),n=p([]),_=p(!1),r=p(),h=p(),g=p([]),{data:v}=([f,z]=ee(()=>ae("chat-config",()=>fe())),f=await f,z(),f),T=C(()=>v.value?.suggestionsEnabled??!0),q=C(()=>v.value?.suggestions||[]),M=C(()=>v.value?.welcomeInfo||{});function D(t){g.value=t}function V(){try{const t=JSON.parse(localStorage.getItem("mcpIds")||"[]");return Array.isArray(t)?t:[]}catch{return[]}}function L(t){t.length?localStorage.setItem("mcpIds",JSON.stringify(t)):localStorage.removeItem("mcpIds")}const E=async()=>{try{const t=await de();if(!t)return;r.value=t,h.value=t.id,_.value=V().includes(h.value||"")}catch(t){console.error("Failed to fetch quick menu:",t)}};async function B(t){try{if(!u.value&&le().isLogin){ce().warning(P("ai-chat.frontend.selectModel"));return}const o=await _e({title:""});Q.setPendingConversation({id:o.id,modelId:u.value,title:t,files:g.value.length>0?g.value:void 0}),ue("chats"),await me({path:`/chat/${o.id}`})}catch(o){console.error("Failed to create conversation:",o)}}const R=()=>{if(!h.value)return;Array.isArray(n.value)||(n.value=[]);const t=V(),o=h.value,A=t.includes(o),y=n.value.includes(o);if(!A&&!y)t.push(o),y||n.value.push(o),L(t);else{const U=t.filter(m=>m!==o),x=n.value.filter(m=>m!==o);L(U),n.value=x}_.value=V().includes(o)};return te(()=>{E()}),(t,o)=>{const A=K,y=Y,U=Z,x=ne,m=ie,G=pe;return i(),S("div",ge,[s("div",{class:F(["border-border/50 h-full flex-none border-r pl-0 sm:pl-2",{"border-none":!e(b).chatSidebarVisible}])},[w(A)],2),s("div",ve,[s("div",ye,[s("div",xe,[s("h1",Ce,l(e(M).title),1),s("p",Se,l(e(M).description),1)]),s("div",we,[w(G,{class:"[view-transition-name:chat-prompt]",modelValue:e(k),"onUpdate:modelValue":o[2]||(o[2]=a=>j(k)?k.value=a:null),"file-list":e(g),rows:2,needAuth:!0,attachmentSizeLimit:e(v)?.attachmentSizeLimit,onSubmit:B,"onUpdate:fileList":D},{"panel-left":N(()=>[w(y,{modelValue:e(u),"onUpdate:modelValue":o[0]||(o[0]=a=>j(u)?u.value=a:null),modelId:e(u)||"",supportedModelTypes:["llm"],"show-billingRule":!0,"open-local-storage":!0,placeholder:"选择AI模型开始对话",onChange:e(b).setSelectedModel},null,8,["modelValue","modelId","onChange"]),w(U,{modelValue:e(n),"onUpdate:modelValue":o[1]||(o[1]=a=>j(n)?n.value=a:null),mcpIds:e(n)||[],placeholder:"选择MCP..."},null,8,["modelValue","mcpIds"]),e(r)?(i(),I(m,{key:0,color:e(_)?"primary":"neutral",variant:"ghost",icon:e(r)?.icon?"":"tabler:tool",ui:{leadingIcon:"size-4"},class:F({"bg-primary/10":e(_)}),onClick:re(R,["stop"])},{default:N(()=>[e(r)?.icon?(i(),I(x,{key:0,src:e(r)?.icon,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),$(" "+l(e(r)?.alias||e(r)?.name),1)]),_:1},8,["color","icon","class"])):d("",!0)]),_:1},8,["modelValue","file-list","attachmentSizeLimit"])]),e(T)?(i(),S("div",Ie,[(i(!0),S(oe,null,se(e(q),(a,J)=>(i(),I(m,{key:J,variant:"outline",color:"neutral",size:"md",onClick:je=>B(a.text)},{default:N(()=>[s("span",be,l(a.icon),1),$(" "+l(a.text),1)]),_:2},1032,["onClick"]))),128))])):d("",!0)]),s("div",ke,[s("div",Me,[s("span",null,l(e(M).footer),1),s("div",Ve,[s("a",{href:e(c).siteConfig?.copyright.url,target:"_blank",rel:"noopener noreferrer",class:"hover:text-primary flex items-center justify-center gap-1 transition-colors"},[e(c).siteConfig?.copyright.iconUrl?(i(),I(x,{key:0,src:e(c).siteConfig?.copyright.iconUrl,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),s("span",null,l(e(c).siteConfig?.copyright.displayName),1)],8,Ae),e(c).siteConfig?.copyright.displayName||e(c).siteConfig?.copyright.iconUrl?(i(),S("span",Ue,"|")):d("",!0),o[3]||(o[3]=s("span",{class:"space-x-1"},[s("span",null,"Powered by"),s("a",{class:"text-primary font-bold",href:"https://www.buildingai.cc",target:"_blank"}," BuildingAI ")],-1))])])])])])}}});export{Mt as default};
