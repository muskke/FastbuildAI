const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BEvzvg0D.js","./BruVSCWF.js","./IZm275qp.js","./DS-TE4M7.js","./BgHJjJs-.js","./B-uid8Vg.js","./Ctr0lhsh.js","./Btvd554H.js","./DuSMYVIA.js","./BPKB8n-W.js","./eVnJMZM-.js","./DHFmmngs.js","./CR1AS2Ry.js","./kRIii9yh.js","./V9POJiZu.js","./D6yWePie.js","./C3zg6GHm.js","./MN31c9CG.js","./C7UmhjTd.js","./BFVs1AfH.js","./C6Y-ieo6.js","./B-DdbQ-X.js","./CuOaO1Pb.js","./3UOIlTK8.js","./Dg6D3RQ3.js","./D-6Co9ha.js","./CXUt0j5Y.js","./-Eb02sIQ.js","./Dk6FGhu1.js","./CCcv9mzY.js","./BFAo_s2U.js","./Cb04SOqd.js","./VGKgjfSv.js","./pWePb4LA.js","./Rtwz8sNN.js","./BUyfW8JT.js","./DaWZu8wl.js","./Dx01Lm3C.js"])))=>i.map(i=>d[i]);
import{d as z,b as E,ap as M,e as N,Q as j,aL as F,s as O,g as q,h as _,i as Q,c as G,o as H,q as m,l as c,p as a,k as p,x as y,v as S,_ as J,R as W,U as X}from"#entry";import{_ as Y}from"./ptVgWJmt.js";import{_ as Z}from"./DiYXikHi.js";import ee from"./BruVSCWF.js";import{_ as te}from"./5XG8SC4l.js";import{_ as oe}from"./CQBV3TNh.js";import{_ as ae}from"./jQG0lB_l.js";import{_ as se}from"./CTfStZur.js";import{a as le,d as ce,u as ne,b as ie,c as re,e as de}from"./pWePb4LA.js";import{u as me}from"./JqIoTTmi.js";import"./CgMDXot0.js";import"./CR1AS2Ry.js";import"./DVnbt8cp.js";import"./DuSMYVIA.js";import"./D6yWePie.js";import"./CuOaO1Pb.js";import"./DHFmmngs.js";import"./C3zg6GHm.js";import"./BgHJjJs-.js";import"./BFVs1AfH.js";import"./kRIii9yh.js";import"./Btvd554H.js";import"./MN31c9CG.js";import"./C6Y-ieo6.js";import"./BPKB8n-W.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./3UOIlTK8.js";import"./DduSJdeS.js";import"./VGKgjfSv.js";import"./DlAUqK2U.js";const pe={class:"flex h-full flex-col gap-4"},ue={class:"flex items-center justify-between"},_e={class:"flex items-center gap-2"},fe={class:"flex-1 overflow-y-auto"},ge={class:"bg-background flex items-center justify-end gap-3 py-4"},he={class:"flex items-center gap-1.5"},We=z({__name:"list",setup(be){const v=W(()=>X(()=>import("./BEvzvg0D.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]),import.meta.url)),{t:o}=E(),u=M(),f=N("table"),k=j(),g=Y,x=Z,U=F({name:""}),l=O([]),{paging:n,getLists:r}=me({fetchFun:le,params:U}),A=q(()=>[{id:"select",accessorKey:"select",header:({table:e})=>_(g,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>{e.toggleAllPageRowsSelected(!!t),I(t)},"aria-label":"Select all"}),cell:({row:e})=>_(g,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>{e.toggleSelected(!!t),D(e,t)},"aria-label":"Select row"})},{accessorKey:"name",header:o("ai-secret.backend.list.form.name")},{accessorKey:"template",header:o("ai-secret.backend.list.form.keyType"),cell:({row:e})=>e.original.template.name},{accessorKey:"remark",header:o("ai-secret.backend.list.form.remark")},{accessorKey:"status",header:o("console-common.status")},{accessorKey:"createdAt",header:o("console-common.createAt"),cell:({row:e})=>{const t=e.getValue("createdAt");return _(x,{datetime:t,mode:"datetime"})}},{id:"action",accessorKey:"action",header:o("console-common.operation")}]),C=e=>[{label:o("console-common.edit"),icon:"i-lucide-edit",onClick:()=>{h(e.original.id)}},{label:o("console-common.delete"),icon:"i-lucide-trash",color:"error",onSelect(){V(e.original.id)}}],h=e=>{k.create(v).open({id:e,onSubmit:(d,i)=>{$(d,i)}})},w=()=>{h()},V=async e=>{await ce(e),u.success(o("console-common.deleteSuccess")),r()},R=async e=>{if(!e.original.id){console.error("行数据缺少 ID");return}try{await ne(e.original.id,{status:e.original.status}),u.success(e.original.status?o("console-common.enableSuccess"):o("console-common.disableSuccess")),r()}catch(t){console.error("更新状态失败:",t)}},D=(e,t)=>{if(typeof t=="boolean"){const d=e.original.id;t?l.value.push(d):l.value=l.value.filter(i=>i!==d),console.log(l.value)}},I=e=>{typeof e=="boolean"&&(e?l.value=n.items.map(t=>t.id):l.value=[])},P=async()=>{try{await ie(l.value),l.value=[],f.value?.tableApi.toggleAllPageRowsSelected(!1),u.success(o("console-common.batchDeleteSuccess")),r()}catch(e){console.error("批量删除失败:",e)}},$=async(e,t)=>{t?await re(t,e):await de(e),u.success(o("ai-secret.backend.list.edit.submitSuccess")),r()};return Q(()=>r()),(e,t)=>{const d=ee,i=J,B=te,K=oe,L=ae,T=se;return H(),G("div",pe,[m("div",ue,[c(d,{placeholder:a(o)("ai-secret.backend.list.placeholder")},null,8,["placeholder"]),m("div",_e,[c(i,{icon:"i-tabler-trash",color:"error",variant:"outline",onClick:P},{default:p(()=>[y(S(a(o)("console-common.batchDelete")),1)]),_:1}),c(i,{color:"primary",icon:"i-lucide-plus",onClick:w},{default:p(()=>[y(S(a(o)("ai-secret.backend.list.add")),1)]),_:1})])]),m("div",fe,[c(L,{ref_key:"table",ref:f,class:"h-full",sticky:"",columns:a(A),data:a(n).items,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"}},{"status-cell":p(({row:s})=>[c(B,{"model-value":!!s.original.status,"onUpdate:modelValue":b=>s.original.status=b?1:0,onChange:b=>R(s)},null,8,["model-value","onUpdate:modelValue","onChange"])]),"action-cell":p(({row:s})=>[c(K,{items:C(s)},{default:p(()=>[c(i,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost"})]),_:1},8,["items"])]),_:1},8,["columns","data"])]),m("div",ge,[m("div",he,[c(T,{page:a(n).page,"onUpdate:page":t[0]||(t[0]=s=>a(n).page=s),size:a(n).pageSize,"onUpdate:size":t[1]||(t[1]=s=>a(n).pageSize=s),total:a(n).total,onChange:a(r)},null,8,["page","size","total","onChange"])])])])}}});export{We as default};
