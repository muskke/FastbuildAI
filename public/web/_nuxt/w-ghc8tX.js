import{_ as G}from"./5XG8SC4l.js";import J from"./BruVSCWF.js";import{_ as Q}from"./DS-TE4M7.js";import{_ as K}from"./CRoF6I1E.js";import W from"./Dg6D3RQ3.js";import{d as X,aI as Y,ap as Z,b as ee,au as oe,s as le,w as te,aJ as ie,i as ae,j as x,o as c,k as n,l as r,q as d,v as s,p as e,x as k,c as f,F as de,B as re,t as y,z as ne,_ as se}from"#entry";import{_ as me}from"./DZjlY_x0.js";import{_ as pe}from"./i5AwkGQh.js";import{_ as ce}from"./D-6Co9ha.js";import{e as ue}from"./qOW3iPfA.js";import{c as fe,a as g,e as C,b as w}from"./BUyfW8JT.js";import"./BgHJjJs-.js";import"./CR1AS2Ry.js";import"./C3zg6GHm.js";import"./DHFmmngs.js";import"./Btvd554H.js";import"./BPKB8n-W.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./MN31c9CG.js";import"./BstbYvQo.js";import"./DuSMYVIA.js";import"./BwAI6jgh.js";import"./BP0i4hNs.js";import"./CgMDXot0.js";import"./C6Y-ieo6.js";import"./BcsO9TDZ.js";import"./DlAUqK2U.js";import"./ptVgWJmt.js";import"./DVnbt8cp.js";import"./D6yWePie.js";import"./CuOaO1Pb.js";import"./CQBV3TNh.js";import"./BFVs1AfH.js";import"./kRIii9yh.js";import"./3UOIlTK8.js";import"./DduSJdeS.js";import"./VGKgjfSv.js";import"./CB78hAg2.js";import"./Cif_tCX1.js";import"./CvUJEDIF.js";import"./C7UmhjTd.js";import"./BJ10eFuk.js";import"./BREwXy1w.js";import"./DaWZu8wl.js";const be={class:"space-y-4 rounded-lg lg:col-span-2"},_e={class:"flex items-center justify-between"},ve={class:"text-secondary-foreground text-sm font-medium"},xe={class:"text-muted-foreground mt-1 text-xs"},ke={class:"flex w-full items-center gap-2"},ge={class:"text-muted-foreground text-sm"},he={class:"text-muted-foreground text-xs"},ye={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},Ce={class:"text-muted-foreground text-xs"},Ve={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},Ue={class:"text-muted-foreground text-sm"},Re={class:"text-muted-foreground text-xs"},Te={class:"space-y-4"},we={class:"flex items-start justify-between gap-3"},$e={class:"min-w-0 flex-1"},qe={key:0},Pe={class:"text-sm font-medium"},Fe={class:"text-muted-foreground mt-1 text-xs"},Me={key:1,class:"space-y-2"},Be={class:"grid grid-cols-1 gap-2"},Le={key:0,class:"text-xs text-red-500"},Ie={class:"flex items-center gap-2"},je={key:0,class:"pt-2"},ze={class:"flex justify-center pt-4"},Ae={class:"flex justify-end gap-4"},Fo=X({__name:"model-form",props:{isEdit:{type:Boolean,default:!1},id:{default:""},initialData:{default:()=>({})}},emits:["submit-success","cancel"],setup($,{emit:q}){const V=$,U=q,{query:P}=Y(),F=Z(),{t:o}=ee(),M=()=>[{field:"temperature",title:o("ai-provider.backend.modelConfig.temperature.title"),description:o("ai-provider.backend.modelConfig.temperature.description"),value:1,enable:!0},{field:"top_p",title:o("ai-provider.backend.modelConfig.top_p.title"),description:o("ai-provider.backend.modelConfig.top_p.description"),value:1,enable:!0},{field:"max_tokens",title:o("ai-provider.backend.modelConfig.max_tokens.title"),description:o("ai-provider.backend.modelConfig.max_tokens.description"),value:4096,enable:!0},{field:"top_k",title:o("ai-provider.backend.modelConfig.top_k.title"),description:o("ai-provider.backend.modelConfig.top_k.description"),value:50,enable:!0},{field:"frequency_penalty",title:o("ai-provider.backend.modelConfig.frequency_penalty.title"),description:o("ai-provider.backend.modelConfig.frequency_penalty.description"),value:0,enable:!0},{field:"presence_penalty",title:o("ai-provider.backend.modelConfig.presence_penalty.title"),description:o("ai-provider.backend.modelConfig.presence_penalty.description"),value:0,enable:!0},{field:"stop",title:o("ai-provider.backend.modelConfig.stop.title"),description:o("ai-provider.backend.modelConfig.stop.description"),value:null,enable:!1}],h={temperature:{min:0,max:2,step:.1},top_p:{min:0,max:1,step:.1},max_tokens:{min:1,max:2048,step:1},top_k:{min:1,max:100,step:1},frequency_penalty:{min:0,max:2,step:.1},presence_penalty:{min:0,max:2,step:.1}},i=oe({name:"",providerId:"",model:"",maxContext:3,modelConfig:M(),isActive:!0,isDefault:!1,description:"",sortOrder:0,modelType:void 0,billingRule:{power:0,tokens:1e3}}),R=le([]),B=fe({name:g().required(o("ai-provider.backend.model.validation.nameRequired")).max(100,o("ai-provider.backend.model.validation.nameMaxLength")),model:g().required(o("ai-provider.backend.model.validation.modelRequired")).max(100,o("ai-provider.backend.model.validation.modelMaxLength")),maxTokens:C().min(1,o("ai-provider.backend.model.validation.maxTokensMin")).nullable(),maxContext:C().min(1,o("ai-provider.backend.model.validation.maxContextMin")).nullable(),description:g().max(500,o("ai-provider.backend.model.validation.descriptionMaxLength")).nullable(),isActive:w(),isDefault:w(),sortOrder:C().nullable(),modelType:g().required(o("ai-provider.backend.model.validation.modelTypeRequired"))}),L=async()=>{const t=await ue({providerId:P.providerId});R.value=t};te(()=>V.initialData,t=>{t&&Object.keys(t).length>0&&Object.assign(i,{name:t.name||"",providerId:t.providerId||"",model:t.model||"",maxContext:t.maxContext,maxTokens:t.maxTokens,modelConfig:t.modelConfig,isActive:t.isActive??!0,isDefault:t.isDefault??!1,description:t.description||"",sortOrder:t.sortOrder||0,modelType:t.modelType||"",billingRule:{power:t.billingRule?.power||0,tokens:t.billingRule?.tokens||0}})},{immediate:!0,deep:!0});const{isLock:I,lockFn:j}=ie(async()=>{try{const t={...i};U("submit-success",t)}catch(t){console.error("Form validation failed:",t),F.error(o("console-common.formValidationFailed"))}}),z=()=>{U("cancel")},T=(t,a)=>i.modelConfig?i.modelConfig.some((b,m)=>m!==a&&b.field===t&&t.trim()!==""):!1,A=t=>{i.modelConfig?.splice(t,1)},N=()=>{const t={field:"",title:"",description:"",value:null,enable:!0};i.modelConfig?.push(t)};return ae(()=>L()),(t,a)=>{const b=G,m=J,u=Q,S=K,O=W,_=se,E=me,H=pe,D=ce;return c(),x(D,{ref:"formRef",state:e(i),schema:e(B),class:"space-y-8",onSubmit:e(j)},{default:n(()=>[r(H,{class:"h-120",shadow:!1},{default:n(()=>[d("div",be,[d("div",_e,[d("div",null,[d("h4",ve,s(e(o)("ai-provider.backend.model.form.isDefault")),1),d("p",xe,s(e(o)("ai-provider.backend.model.form.setAsDefault")),1)]),r(b,{modelValue:e(i).isDefault,"onUpdate:modelValue":a[0]||(a[0]=l=>e(i).isDefault=l),"unchecked-icon":"i-lucide-star-off","checked-icon":"i-lucide-star",color:"warning"},null,8,["modelValue"])]),r(u,{label:e(o)("ai-provider.backend.model.form.billing"),name:"billing"},{hint:n(()=>[d("span",he,s(e(o)("ai-provider.backend.model.form.billingHelp")),1)]),default:n(()=>[d("div",ke,[r(m,{modelValue:e(i).billingRule.power,"onUpdate:modelValue":a[1]||(a[1]=l=>e(i).billingRule.power=l),modelModifiers:{number:!0},type:"number",placeholder:"",min:0,class:"flex-1",ui:{base:"pr-15"},onBlur:a[2]||(a[2]=l=>{e(i).billingRule.power<0&&(e(i).billingRule.power=0)})},{trailing:n(()=>[d("span",ge,s(e(o)("ai-provider.backend.model.form.power")),1)]),_:1},8,["modelValue"]),a[11]||(a[11]=d("span",null,"/",-1)),r(m,{modelValue:e(i).billingRule.tokens,"onUpdate:modelValue":a[3]||(a[3]=l=>e(i).billingRule.tokens=l),modelModifiers:{number:!0},type:"number",placeholder:"",min:1,class:"flex-1",ui:{base:"pr-15"},disabled:!0,onBlur:a[4]||(a[4]=l=>{e(i).billingRule.tokens<1&&(e(i).billingRule.tokens=1)})},{trailing:n(()=>[...a[10]||(a[10]=[d("span",{class:"text-muted-foreground text-sm"}," Tokens ",-1)])]),_:1},8,["modelValue"])])]),_:1},8,["label"]),d("div",ye,[r(u,{label:e(o)("ai-provider.backend.model.form.name"),name:"name",required:""},{hint:n(()=>[d("span",Ce,s(e(o)("ai-provider.backend.model.form.nameHelp")),1)]),default:n(()=>[r(m,{modelValue:e(i).name,"onUpdate:modelValue":a[5]||(a[5]=l=>e(i).name=l),placeholder:e(o)("ai-provider.backend.model.form.namePlaceholder"),maxlength:100,class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:e(o)("ai-provider.backend.model.form.model"),name:"model",required:""},{default:n(()=>[r(m,{modelValue:e(i).model,"onUpdate:modelValue":a[6]||(a[6]=l=>e(i).model=l),placeholder:e(o)("ai-provider.backend.model.form.modelPlaceholder"),maxlength:100,class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),d("div",Ve,[r(u,{label:e(o)("ai-provider.backend.model.form.maxContext"),name:"maxContext"},{hint:n(()=>[d("span",Re,s(e(o)("ai-provider.backend.model.form.maxContextHelp")),1)]),default:n(()=>[r(m,{modelValue:e(i).maxContext,"onUpdate:modelValue":a[7]||(a[7]=l=>e(i).maxContext=l),modelModifiers:{number:!0},type:"number",placeholder:e(o)("ai-provider.backend.model.form.maxContextPlaceholder"),min:1,ui:{root:"w-full",base:"pr-15"}},{trailing:n(()=>[d("span",Ue,s(e(o)("ai-provider.backend.model.form.maxContextUnit")),1)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:e(o)("ai-provider.backend.model.form.modelType"),name:"modelType",required:""},{default:n(()=>[r(S,{modelValue:e(i).modelType,"onUpdate:modelValue":a[8]||(a[8]=l=>e(i).modelType=l),items:e(R),placeholder:e(o)("ai-provider.backend.model.form.modelTypePlaceholder"),class:"w-full"},null,8,["modelValue","items","placeholder"])]),_:1},8,["label"])]),r(u,{label:e(o)("ai-provider.backend.model.form.description"),name:"description"},{default:n(()=>[r(O,{modelValue:e(i).description,"onUpdate:modelValue":a[9]||(a[9]=l=>e(i).description=l),placeholder:e(o)("ai-provider.backend.model.form.descriptionPlaceholder"),maxlength:500,rows:4,class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d("div",Te,[r(E,{items:[{}],ui:{header:"px-0 ",label:"text-lg font-semibold",content:"px-0",body:"flex flex-col gap-2",trigger:" !shadow-none"}},{body:n(()=>[(c(!0),f(de,null,re(e(i).modelConfig,(l,v)=>(c(),f("div",{key:`${l.field}-${v}`,class:"bg-muted rounded-lg p-4"},[d("div",we,[d("div",$e,[h[l.field]?(c(),f("div",qe,[d("h4",Pe,s(l.title),1),d("p",Fe,s(l.description),1)])):(c(),f("div",Me,[d("div",Be,[r(m,{modelValue:l.field,"onUpdate:modelValue":p=>l.field=p,placeholder:e(o)("ai-provider.backend.modelConfig.custom.fieldPlaceholder"),class:ne(T(l.field,Number(v))?"border-red-500":""),ui:{root:"w-full"}},null,8,["modelValue","onUpdate:modelValue","placeholder","class"]),r(m,{modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,placeholder:e(o)("ai-provider.backend.modelConfig.custom.valuePlaceholder"),class:"w-full"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),T(l.field,Number(v))?(c(),f("p",Le,s(e(o)("ai-provider.backend.modelConfig.validation.duplicateField")),1)):y("",!0)]))]),d("div",Ie,[r(b,{modelValue:l.enable,"onUpdate:modelValue":p=>l.enable=p,size:"sm"},null,8,["modelValue","onUpdate:modelValue"]),h[l.field]?y("",!0):(c(),x(_,{key:0,color:"error",variant:"ghost",size:"xs",icon:"i-lucide-trash-2",onClick:p=>A(Number(v))},null,8,["onClick"]))])]),l.enable&&h[l.field]?(c(),f("div",je,[l.field==="stop"?(c(),x(m,{key:0,modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,placeholder:e(o)("ai-provider.backend.modelConfig.stop.placeholder"),size:"sm",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):(c(),x(m,{key:1,modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,placeholder:e(o)("ai-provider.backend.modelConfig.stop.placeholder"),size:"sm",class:"w-full",type:"number"},null,8,["modelValue","onUpdate:modelValue","placeholder"]))])):y("",!0)]))),128)),d("div",ze,[r(_,{color:"primary",variant:"soft",size:"sm",icon:"i-lucide-plus",onClick:N},{default:n(()=>[k(s(e(o)("ai-provider.backend.modelConfig.addParameter")),1)]),_:1})])]),default:n(()=>[k(s(e(o)("ai-provider.backend.modelConfig.title"))+" ",1)]),_:1})])])]),_:1}),d("div",Ae,[r(_,{color:"neutral",variant:"outline",onClick:z,class:"px-8"},{default:n(()=>[k(s(e(o)("console-common.cancel")),1)]),_:1}),r(_,{color:"primary",loading:e(I),type:"submit",class:"px-8"},{default:n(()=>[k(s(V.isEdit?e(o)("console-common.update"):e(o)("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"])}}});export{Fo as default};
