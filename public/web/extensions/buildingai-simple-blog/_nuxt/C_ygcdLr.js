import{j as S,f as M,N as q,d as h,o as y,b0 as b,ad as r,af as g,ap as m,aG as u,am as w,aH as $,aL as j,aI as U,at as D,aA as o,a2 as E,r as O,aK as F,y as T,as as A}from"#entry";import{_ as G}from"./Dg4vAJXg.js";import{c as H,a as K,_ as P,d as R}from"./e6MZFdVl.js";import{_ as J}from"./B8SJhcNl.js";import{_ as Q}from"./BJKFgWrD.js";import{d as W}from"./DA9fpWkJ.js";import{d as X,e as Y,f as Z}from"./DOVLrnnX.js";import{u as ee}from"./BoxSbMi3.js";import{u as I}from"./D1hA3BKJ.js";import"./CqkleIqs.js";import"./okr9Ajys.js";import"./B5IAfFKH.js";import"./76gj8Op9.js";import"./Bc7nvvil.js";import"./DCg0SI8n.js";const oe=["id"],te={class:"pr- flex items-center justify-between"},le={class:"text-lg font-medium md:text-xl"},ae={key:0,class:"text-muted-foreground mt-1 text-sm"},se={class:"flex-1 overflow-hidden overflow-y-auto"},ne={class:"flex justify-end gap-2"},ie=S({inheritAttrs:!1,__name:"index",props:{title:{default:"Title"},description:{},transition:{type:Boolean,default:!0},fullscreen:{type:Boolean,default:!1},dismissible:{type:Boolean,default:!1},overlay:{type:Boolean,default:!0},portal:{type:Boolean,default:!0},open:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},disabledClose:{type:Boolean,default:!1},contentId:{default:""},closeIcon:{default:"tabler:x"},closeOnEsc:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!1},ui:{default:()=>({})}},emits:["update:open","update:modelValue","open","close","confirm"],setup(t,{expose:_,emit:c}){const d=t,e=c,s=M({get:()=>d.open??d.modelValue??!1,set:l=>{e("update:open",l),e("update:modelValue",l)}});function a(){d.disabledClose||(s.value=!1,e("close"))}function k(){s.value=!1,e("confirm")}function v(){s.value=!0,console.log("open",s.value),e("open")}return q(s,l=>{l&&e("open")}),W({"alt+o":()=>{s.value=!s.value},escape:()=>{s.value&&d.closeOnEsc&&!d.disabledClose&&a()}}),_({close:a,open:v}),(l,f)=>{const n=j,i=Q;return y(),h("div",null,[l.$slots.trigger?(y(),h("div",{key:0,class:"cursor-pointer",onClick:v},[g(l.$slots,"trigger")])):b("",!0),r(i,D({open:o(s),"onUpdate:open":f[0]||(f[0]=C=>E(s)?s.value=C:null)},l.$attrs,{ui:t.ui,portal:t.portal,fullscreen:t.fullscreen,overlay:t.overlay,transition:t.transition,dismissible:t.dismissible,onClose:f[1]||(f[1]=()=>{s.value=!1,e("close")})}),{content:m(()=>[u("div",{id:t.contentId,class:"relative flex flex-col gap-4 overflow-hidden p-4 sm:p-6"},[u("div",te,[g(l.$slots,"title",{},()=>[u("div",null,[u("h2",le,$(t.title),1),t.description?(y(),h("p",ae,$(t.description),1)):b("",!0)])]),t.disabledClose?b("",!0):(y(),w(n,{key:0,class:"absolute top-4 right-4",icon:t.closeIcon,color:"neutral",size:"sm",variant:"ghost","aria-label":"Close modal",onClick:a},null,8,["icon"]))]),u("div",se,[g(l.$slots,"default")]),t.showFooter||l.$slots.footer?g(l.$slots,"footer",{key:0},()=>[u("div",ne,[r(n,{color:"neutral",variant:"soft",size:"lg",onClick:a},{default:m(()=>[U($(l.$t("common.cancel")),1)]),_:1}),r(n,{color:"primary",size:"lg",onClick:k},{default:m(()=>[U($(l.$t("common.confirm")),1)]),_:1})])]):b("",!0)],8,oe)]),_:3},16,["open","ui","portal","fullscreen","overlay","transition","dismissible"])])}}}),re={key:0,class:"flex items-center justify-center",style:{padding:"100px 0"}},de={class:"space-y-4"},ce={class:"mt-6 flex justify-end gap-3"},Ve=S({__name:"edit",props:{id:{}},emits:["close"],setup(t,{emit:_}){const c=t,d=_,{t:e}=ee(),s=H({name:K().required(e("column.edit.form.name.required"))}),a=O({name:"",description:"",sort:0}),{lockFn:k,isLock:v}=I(async()=>{if(c.id)try{const n=await X(c.id);a.value={name:n.name,description:n.description||"",sort:n.sort||0}}catch(n){console.error("获取详情失败:",n)}}),{lockFn:l,isLock:f}=I(async()=>{try{c.id?await Y(c.id,a.value):await Z(a.value),F().success(c.id?e("column.edit.messages.updateSuccess"):e("column.edit.messages.createSuccess")),d("close",!0)}catch(n){console.error("提交失败:",n),F().error(c.id?e("column.edit.messages.updateFailed"):e("column.edit.messages.createFailed"))}});return T(()=>{k()}),(n,i)=>{const C=A,V=G,B=R,N=J,x=j,z=P,L=ie;return y(),w(L,{title:t.id?o(e)("column.edit.title.edit"):o(e)("column.edit.title.create"),description:t.id?o(e)("column.edit.description.edit"):o(e)("column.edit.description.create"),ui:{content:"w-md"},onClose:i[4]||(i[4]=p=>d("close"))},{default:m(()=>[o(v)?(y(),h("div",re,[r(C,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):(y(),w(z,{key:1,state:o(a),schema:o(s),class:"space-y-2",onSubmit:o(l)},{default:m(()=>[u("div",de,[r(B,{label:o(e)("column.edit.form.name.label"),name:"name",required:""},{default:m(()=>[r(V,{modelValue:o(a).name,"onUpdate:modelValue":i[0]||(i[0]=p=>o(a).name=p),placeholder:o(e)("column.edit.form.name.placeholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(B,{label:o(e)("column.edit.form.description.label"),name:"description"},{default:m(()=>[r(N,{"model-value":o(a).description||"","onUpdate:modelValue":i[1]||(i[1]=p=>o(a).description=p||void 0),placeholder:o(e)("column.edit.form.description.placeholder"),rows:3,ui:{root:"w-full"}},null,8,["model-value","placeholder"])]),_:1},8,["label"]),r(B,{label:o(e)("column.edit.form.sort.label"),name:"sort"},{default:m(()=>[r(V,{modelValue:o(a).sort,"onUpdate:modelValue":i[2]||(i[2]=p=>o(a).sort=p),type:"number",placeholder:o(e)("column.edit.form.sort.placeholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),u("div",ce,[r(x,{color:"neutral",variant:"outline",label:o(e)("column.edit.buttons.cancel"),onClick:i[3]||(i[3]=p=>d("close"))},null,8,["label"]),r(x,{type:"submit",color:"primary",loading:o(f),label:o(f)?o(e)("column.edit.buttons.saving"):o(e)("column.edit.buttons.save")},null,8,["loading","label"])])]),_:1},8,["state","schema","onSubmit"]))]),_:1},8,["title","description"])}}});export{Ve as default};
