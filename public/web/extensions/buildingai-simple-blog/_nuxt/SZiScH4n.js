const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C_ygcdLr.js","./D2sM-ruY.js","./Dg4vAJXg.js","./e6MZFdVl.js","./CqkleIqs.js","./B8SJhcNl.js","./BJKFgWrD.js","./okr9Ajys.js","./B5IAfFKH.js","./76gj8Op9.js","./Bc7nvvil.js","./DA9fpWkJ.js","./DCg0SI8n.js","./DOVLrnnX.js","./BoxSbMi3.js","./D1hA3BKJ.js"])))=>i.map(i=>d[i]);
import{j as F,aK as U,aP as L,aQ as M,ah as K,r as P,f as T,y as B,d as O,aG as b,ad as c,aR as E,aA as o,ap as f,aH as u,aN as N,aO as z,o as H,aI as S,aL as j,p as l}from"#entry";import{_ as G}from"./hJ5gZnUc.js";import{_ as Q}from"./Bz7Re0hC.js";import{_ as q}from"./J_F_phuk.js";import{_ as J}from"./Dg4vAJXg.js";import{_ as W}from"./DdhQ6uYb.js";import{u as X,_ as Y}from"./EfHfYcew.js";import{a as Z,b as ee,c as te}from"./DOVLrnnX.js";import{u as ae}from"./BoxSbMi3.js";import{u as oe}from"./D1hA3BKJ.js";import"./2wZIfpcm.js";import"./DL81yhuu.js";import"./76gj8Op9.js";import"./Ch_HQEI2.js";import"./C6LGytJn.js";import"./DMnTxglc.js";import"./DStvts-W.js";import"./BEYdQPJu.js";import"./Bc7nvvil.js";import"./B5IAfFKH.js";import"./C2wkO8_v.js";import"./DCg0SI8n.js";const le={class:"column-list-container pb-5"},se={class:"mb-4 flex flex-wrap gap-4"},re={class:"flex items-end gap-2 md:ml-auto"},ne={class:"border-default mt-auto flex items-center justify-between gap-3 border-t pt-4"},ie={class:"text-muted text-sm"},Fe=F({__name:"list",setup(ce){const C=N(()=>z(()=>import("./C_ygcdLr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),w=G,n=j,A=Q,k=q,h=U(),{t:a}=ae(),V=L(),r=M("table"),_=K({name:""}),y=P([]),d=T(()=>({select:a("column.list.table.columns.select"),name:a("column.list.table.columns.name"),sort:a("column.list.table.columns.sort"),articleCount:a("column.list.table.columns.articleCount"),createdAt:a("column.list.table.columns.createdAt"),actions:a("column.list.table.columns.actions")})),I=[{id:"select",header:({table:e})=>l(w,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>e.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:e})=>l(w,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>e.toggleSelected(!!t),ariaLabel:"Select row"})},{accessorKey:"name",header:()=>l("p",{class:""},`${d.value.name}`),cell:({row:e})=>{const t=e.original;return l("div",{class:"flex items-center gap-3"},[l("div",void 0,[l("p",{class:"font-medium"},t.name),t.description?l("p",{class:"truncate text-sm text-muted-foreground dark:text-gray-400"},t.description):null])])}},{accessorKey:"sort",header:({column:e})=>{const t=e.getIsSorted();return l(n,{color:"neutral",variant:"ghost",label:d.value.sort,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("sort");return l("span",{class:"text-accent-foreground"},t||0)}},{accessorKey:"articleCount",header:()=>l("p",{class:""},`${d.value.articleCount}`),cell:({row:e})=>{const t=e.getValue("articleCount");return l("span",{class:"text-accent-foreground"},t||0)}},{accessorKey:"createdAt",header:({column:e})=>{const t=e.getIsSorted();return l(n,{color:"neutral",variant:"ghost",label:d.value.createdAt,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("createdAt");if(!t)return l("span",{class:"text-accent-foreground text-sm"},"-");const i=t instanceof Date?t.toISOString():typeof t=="string"?t:"";return l("span",{class:"text-accent-foreground text-sm"},i?l(k,{datetime:i,mode:"date"}):"-")}},{id:"actions",header:()=>l("p",{class:""},`${d.value.actions}`),size:40,enableSorting:!1,enableHiding:!1,cell:({row:e})=>l("div",{class:"flex items-center gap-1"},[l(n,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:a("column.list.table.actions.edit"),onClick:()=>{v(e.original.id)}}),l(n,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:a("column.list.table.actions.delete"),onClick:()=>{x(e.original.id)}})])}],{lockFn:p,isLock:R}=oe(async()=>{try{const e=await te(_);y.value=e||[]}catch(e){console.error("获取栏目列表失败:",e),h.error(a("column.list.messages.fetchFailed"))}}),v=async(e=null)=>{await V.create(C).open({id:e}).result&&p()},x=async e=>{try{const t=Array.isArray(e),i=a("column.list.messages.warmTip"),g=a(t?"column.list.messages.batchDeleteConfirm":"column.list.messages.deleteConfirm");await X({color:"error",title:i,content:g,confirmText:a("column.list.table.actions.delete"),ui:{content:"!w-sm"}}),t?await Z(e):await ee(e),p(),h.success(a("column.list.messages.deleteSuccess"))}catch(t){console.error("删除失败:",t),h.error(a("column.list.messages.deleteFailed"))}},D=()=>{p()};return B(()=>p()),(e,t)=>{const i=J,g=W,$=Y;return H(),O("div",le,[b("div",se,[c(i,{modelValue:_.name,"onUpdate:modelValue":t[0]||(t[0]=s=>_.name=s),placeholder:o(a)("column.list.search.placeholder"),icon:"i-heroicons-magnifying-glass",onKeyup:E(D,["enter"])},null,8,["modelValue","placeholder"]),b("div",re,[c(o(n),{color:"error",variant:"subtle",label:o(a)("column.list.table.actions.batchDelete"),icon:"i-heroicons-trash",disabled:!o(r)?.tableApi?.getFilteredSelectedRowModel().rows.length,onClick:t[1]||(t[1]=s=>x(o(r)?.tableApi?.getFilteredSelectedRowModel().rows.map(m=>m.original.id)))},{trailing:f(()=>[c(g,null,{default:f(()=>[S(u(o(r)?.tableApi?.getFilteredSelectedRowModel().rows.length),1)]),_:1})]),_:1},8,["label","disabled"]),c(o(A),{items:o(r)?.tableApi?.getAllColumns().filter(s=>s.getCanHide()).map(s=>({label:o(d)[s?.id]||s.columnDef.header,type:"checkbox",checked:s.getIsVisible(),onUpdateChecked(m){o(r)?.tableApi?.getColumn(s.id)?.toggleVisibility(!!m)},onSelect(m){m?.preventDefault()}})),content:{align:"end"}},{default:f(()=>[c(o(n),{label:o(a)("column.list.table.actions.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),c(o(n),{icon:"i-heroicons-plus",color:"primary",onClick:t[2]||(t[2]=s=>v())},{default:f(()=>[S(u(o(a)("column.list.table.actions.create")),1)]),_:1})])]),c($,{loading:o(R),data:o(y),columns:I,class:"shrink-0",ref_key:"table",ref:r,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},null,8,["loading","data"]),b("div",ne,[b("div",ie,u(o(r)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" / "+u(o(r)?.tableApi?.getFilteredRowModel().rows.length||0)+" "+u(o(a)("column.list.table.actions.selected"))+". ",1)])])}}});export{Fe as default};
